import{a as A}from"./ajv.DkVtFaOA.js";import{q as F,V as w,W as v,X as I,Y as p,Z as k,_ as M,$ as y,a0 as E,d as m,b as P,a1 as h,z as U}from"./definitions.Dwc_MNg1.js";import"./_commonjsHelpers.CfDrMh7n.js";function d(e,n,r={type:"root",path:[]}){if(!F(e))return n(e,r);const t={...e};for(const a of w){const i=e[a];if(i===void 0||!Array.isArray(i))continue;const s={type:"array",parent:e,key:a,index:0,path:r.path.concat(a,0)};t[a]=i.map((u,l)=>(s.index=l,s.path[s.path.length-1]=l,d(u,n,s)))}const o=new Map;for(const a of v){const i=e[a];if(i===void 0)continue;const s={type:"record",parent:e,key:a,property:"",path:r.path.concat(a,"")};for(const[u,l]of Object.entries(i))Array.isArray(l)||(s.property=u,s.path[s.path.length-1]=u,o.set(u,d(l,n,s)));t[a]=Object.fromEntries(o),o.clear()}const c={type:"sub",parent:e,key:"items",path:r.path.concat("")};for(const a of I){const i=e[a];i===void 0||Array.isArray(i)||(c.key=a,c.path[c.path.length-1]=a,t[a]=d(i,n,c))}return n(t,r)}function $(e,n){return d(e,r=>{if(!F(r))return r;const t=r[p];return t!==void 0&&t.startsWith("#")&&(r[p]=`${n}${t}`),r})}const D={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},L=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,Y=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function z(e){return e.addFormat("color",L),e.addFormat("data-url",Y),e}function B(e){return e.addKeyword(k),e}function G(e){return B(z(e))}function f(e,n){let r="",t=!1;const o=new WeakMap,c=E(o,a=>{let i=a;return t&&(i=$(a,r),delete i[y]),e.compile(i)});return(a,i)=>{r=i[y]??M;let s=e.getSchema(r)?.schema;return s!==void 0&&s!==i&&(e.removeSchema(r),o.delete(a),s=void 0),s===void 0&&e.addSchema(i,r),t=a!==i,c(a)}}function S(e,n){const t=E(new WeakMap,o=>e.compile({...o,$async:n}));return o=>t(o.schema)}function _({params:{missingProperty:e},parentSchema:n,message:r},t){if(!r)return"";if(e===void 0)return r;const o=t(e,n);return o===void 0?r:r.replace(e,o)}function b(e){const n=({params:{missingProperty:r,propertyName:t},propertyName:o=t},c)=>{let a=P(c,e);return a=r!==void 0?h(a,r,e):a,a=o!==void 0?U(h(a,o,e),"key-input",e):a,a};return r=>r.map(t=>{let o=t.instancePath.split("/");return o[0]===""&&(o=o.slice(1)),{instanceId:n(t,o),propertyTitle:m(e.uiSchema??{},o)??t.parentSchema?.title??o.join("."),message:_(t,(c,a)=>{const i=m(e.uiSchema??{},o.concat(c));if(i!==void 0)return i;const s=a?.properties?.[c];if(typeof s=="object")return s.title}),error:t}})}function R(e){return e.instancePath===""}function H(e){return R(e)&&e.keyword!=="type"}function T(e){return n=>n.filter(e.required?R:H).map(r=>({instanceId:e.id,propertyTitle:e.title,message:_(r,()=>e.title),error:r}))}function V(e,n,r){e(n);const t=e.errors;return e.errors=null,t?r(t):[]}async function O(e,n,r){try{await e(n)}catch(t){if(!(t instanceof A.Ajv.ValidationError))throw t;return r(t.errors)}finally{e.errors=null}return[]}function C({compileSchema:e}){return{isValid(n,r,t){if(typeof n=="boolean")return n;const o=e(n,r);try{return o(t)}catch(c){return console.warn("Failed to validate",c),!1}}}}function K(e){const n=b(e);return{validateFormValue(r,t){return V(e.compileSchema(r,r),t,n)}}}function W({compileFieldSchema:e}){return{validateFieldValue(n,r){return V(e(n),r,T(n))}}}function X(e){const n=b(e);return{async validateFormValueAsync(r,t,o){return O(e.compileAsyncSchema(t,t),o,n)}}}function g({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(n,r,t){return O(e(r),t,T(r))}}}function x({ajvOptions:e=D,ajvPlugins:n=G,ajv:r=n(new A.Ajv(e)),compileSchema:t=f(r),compileFieldSchema:o=S(r,!1),...c}={}){const a={...c,compileSchema:t,compileFieldSchema:o};return Object.assign(C(a),K(a),W(a))}function J({ajv:e,compileSchema:n=f(e),compileAsyncSchema:r=f(e),compileAsyncFieldSchema:t=S(e,!0),...o}){const c={...o,compileSchema:n,compileAsyncSchema:r,compileAsyncFieldSchema:t};return Object.assign(C(c),X(c),g(c))}export{G as a,J as b,x as c,b as d,T as e,$ as p,V as v};
