import"./each.CnJSAi8U.js";import{p as L,f as z,e as C,t as G,b as D,a as B,s as H,h as Y,c as U,r as K}from"./render.BhfrqoSn.js";import{ad as _,g as Q,e as W,O as X,k as Z}from"./definitions.CzRvR1KE.js";import{c as A}from"./en.0vRY1odn.js";import{B as j}from"./basic-form.B96jREB-.js";import{d as S}from"./defaults.BEMJxayK.js";import{i as ee,u as re}from"./index.BPQVTpeN.js";import"./_commonjsHelpers.DaWZu8wl.js";import"./snippet.CJeKierg.js";import"./file.Ca0qCOgj.js";import"./form.wOJ7fy4v.js";import"./content.qdYoKRrn.js";import"./submit-button.M__uqjgw.js";import"./assert.D0YuILwE.js";import"./file-include.CIc1aSLL.js";import"./checkboxes-include.DdVWo2EW.js";function I(e){return`${e}::ag`}var $;function q(e){return{lang:e?.lang??$?.lang,message:e?.message,abortEarly:e?.abortEarly??$?.abortEarly,abortPipeEarly:e?.abortPipeEarly??$?.abortPipeEarly}}var te;function ie(e){return te?.get(e)}var ne;function se(e){return ne?.get(e)}var ue;function ae(e,r){return ue?.get(e)?.get(r)}function M(e){const r=typeof e;return r==="string"?`"${e}"`:r==="number"||r==="bigint"||r==="boolean"?`${e}`:r==="object"||r==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":r}function d(e,r,t,i,s){const u=s&&"input"in s?s.input:t.value,n=s?.expected??e.expects??null,a=s?.received??M(u),p={kind:e.kind,type:e.type,input:u,expected:n,received:a,message:`Invalid ${r}: ${n?`Expected ${n} but r`:"R"}eceived ${a}`,requirement:e.requirement,path:s?.path,issues:s?.issues,lang:i.lang,abortEarly:i.abortEarly,abortPipeEarly:i.abortPipeEarly},l=e.kind==="schema",f=s?.message??e.message??ae(e.reference,p.lang)??(l?se(p.lang):null)??i.message??ie(p.lang);f!==void 0&&(p.message=typeof f=="function"?f(p):f),l&&(t.typed=!1),t.issues?t.issues.push(p):t.issues=[p]}function c(e){return{version:1,vendor:"valibot",validate(r){return e["~run"]({value:r},q())}}}function pe(e,r){const t=[...new Set(e)];return t.length>1?`(${t.join(` ${r} `)})`:t[0]??"never"}function P(e,r){return{kind:"validation",type:"check",reference:P,async:!1,expects:null,requirement:e,message:r,"~run"(t,i){return t.typed&&!this.requirement(t.value)&&d(this,"input",t,i),t}}}function V(e,r){return{kind:"validation",type:"max_length",reference:V,async:!1,expects:`<=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length>this.requirement&&d(this,"length",t,i,{received:`${t.value.length}`}),t}}}function m(e,r){return{kind:"validation",type:"min_length",reference:m,async:!1,expects:`>=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length<this.requirement&&d(this,"length",t,i,{received:`${t.value.length}`}),t}}}function N(e,r){return{kind:"validation",type:"regex",reference:N,async:!1,expects:`${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&!this.requirement.test(t.value)&&d(this,"format",t,i),t}}}function fe(e,r,t){return typeof e.fallback=="function"?e.fallback(r,t):e.fallback}function b(e,r,t){return typeof e.default=="function"?e.default(r,t):e.default}function w(e,r){return{kind:"schema",type:"array",reference:w,expects:"Array",async:!1,item:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const s=t.value;if(Array.isArray(s)){t.typed=!0,t.value=[];for(let u=0;u<s.length;u++){const n=s[u],a=this.item["~run"]({value:n},i);if(a.issues){const p={type:"array",origin:"value",input:s,key:u,value:n};for(const l of a.issues)l.path?l.path.unshift(p):l.path=[p],t.issues?.push(l);if(t.issues||(t.issues=a.issues),i.abortEarly){t.typed=!1;break}}a.typed||(t.typed=!1),t.value.push(a.value)}}else d(this,"type",t,i);return t}}}function F(e){return{kind:"schema",type:"boolean",reference:F,expects:"boolean",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="boolean"?r.typed=!0:d(this,"type",r,t),r}}}function R(e,r){return{kind:"schema",type:"object",reference:R,expects:"Object",async:!1,entries:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const s=t.value;if(s&&typeof s=="object"){t.typed=!0,t.value={};for(const u in this.entries){const n=this.entries[u];if(u in s||(n.type==="exact_optional"||n.type==="optional"||n.type==="nullish")&&n.default!==void 0){const a=u in s?s[u]:b(n),p=n["~run"]({value:a},i);if(p.issues){const l={type:"object",origin:"value",input:s,key:u,value:a};for(const f of p.issues)f.path?f.path.unshift(l):f.path=[l],t.issues?.push(f);if(t.issues||(t.issues=p.issues),i.abortEarly){t.typed=!1;break}}p.typed||(t.typed=!1),t.value[u]=p.value}else if(n.fallback!==void 0)t.value[u]=fe(n);else if(n.type!=="exact_optional"&&n.type!=="optional"&&n.type!=="nullish"&&(d(this,"key",t,i,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:s,key:u,value:s[u]}]}),i.abortEarly))break}}else d(this,"type",t,i);return t}}}function g(e,r){return{kind:"schema",type:"optional",reference:g,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:r,get"~standard"(){return c(this)},"~run"(t,i){return t.value===void 0&&(this.default!==void 0&&(t.value=b(this,t,i)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,i)}}}function T(e,r){return{kind:"schema",type:"picklist",reference:T,expects:pe(e.map(M),"|"),async:!1,options:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){return this.options.includes(t.value)?t.typed=!0:d(this,"type",t,i),t}}}function v(e){return{kind:"schema",type:"string",reference:v,expects:"string",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="string"?r.typed=!0:d(this,"type",r,t),r}}}function le(e,r){const t={};for(const i in e.entries)t[i]=g(e.entries[i]);return{...e,entries:t,get"~standard"(){return c(this)}}}function k(...e){return{...e[0],pipe:e,get"~standard"(){return c(this)},"~run"(r,t){for(const i of e)if(i.kind!=="metadata"){if(r.issues&&(i.kind==="schema"||i.kind==="transformation")){r.typed=!1;break}(!r.issues||!t.abortEarly&&!t.abortPipeEarly)&&(r=i["~run"](r,t))}return r}}}function E(e,r,t){const i=e["~run"]({value:r},q(t));return{typed:i.typed,success:!i.issues,output:i.value,issues:i.issues}}function oe(e){switch(e.type){case"object":case"object_with_rest":case"loose_object":case"strict_object":return k(le(e),P(r=>Object.keys(e.entries).some(t=>r[t]!==void 0),"At least one field must be defined"))}}function ye({map:e=new Map}={}){return{get(r){return e.get(r)},register({errors:r,jsonSchema:t,valibotSchema:i}){if(r!==void 0)return;const s=e.size.toString();e.set(s,i);let u={...t};const n=i;switch(n.type){case"nullable":case"nullish":{const{anyOf:a}=t;if(a===void 0||a.length!==2||!_(a[1])||a[1].type!=="null")throw new Error(`'{ anyOf: [<inner schema>, { type: "null" }] }' schema is expected for ${n.type} Valibot schema, but got '${JSON.stringify(t)}'`);const p=a[0];if(p===void 0||!_(p)||p.type===void 0||Array.isArray(p.type))throw new Error("Your Valibot schema is currently unsupported, please consider opening an issue with your example");u={...p,type:[p.type,"null"]};break}case"union":case"variant":{const{anyOf:a}=t;if(a===void 0||!a.every(_)||n.options.length!==a.length)throw new Error(`Expected 'anyOf' keyword for Valibot ${n.type} type, but got '${Object.keys(t).join(", ")}'`);for(let p=0;p<a.length;p++){const l=n.options[p];if("pipe"in l)throw new Error("unions with pipes currently unsupported");const f=oe(l);if(f===void 0)continue;const{$id:x}=a[p];if(x===void 0)throw new Error("Id for item of 'anyOf' item not found");e.set(I(x),f)}break}}return u.$id=s,u}}}function de(e,r){return e.success?{value:e.output}:{value:r,errors:e.issues.map(t=>({path:t.path?.map(s=>s.key)??[],message:t.message}))}}function ce(e){return e.path===void 0}function ge(e){return e.success?[]:e.issues.filter(ce).map(r=>r.message)}function O(e,{$id:r,allOf:t}){if(r===void 0){const s=t?.[0];if(typeof s=="object"&&s.$id!==void 0)r=I(s.$id);else throw new Error("Schema id not found")}const i=e.get(r);if(i===void 0)throw new Error(`Valibot schema with id "${r}" not found`);return i}function ke({schemaRegistry:e}){return{isValid(r,t,i){if(typeof r=="boolean")return r;const s=O(e,r);return E(s,i).success}}}function me(e){return{validateFormValue(r,t){const i=O(e.schemaRegistry,r);return de(E(i,t),t)}}}function be({schemaRegistry:e}){return{validateFieldValue(r,t){const i=O(e,r.schema);return ge(E(i,t))}}}function _e(e){return Object.assign(ke(e),me(e),be(e))}function y(e,r){return e?(e.push(r),e):[r]}function h(e,r){switch(r?.errorMode){case"ignore":break;case"warn":{console.warn(e);break}default:throw new Error(e)}}function $e(e,r,t){if(t?.ignoreActions?.includes(r.type))return e;let i;switch(r.type){case"base64":{e.contentEncoding="base64";break}case"bic":case"cuid2":case"decimal":case"digits":case"emoji":case"hexadecimal":case"hex_color":case"nanoid":case"octal":case"ulid":{e.pattern=r.requirement.source;break}case"description":{e.description=r.description;break}case"email":{e.format="email";break}case"empty":{e.type==="array"?e.maxItems=0:(e.type!=="string"&&(i=y(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=0);break}case"entries":{e.minProperties=r.requirement,e.maxProperties=r.requirement;break}case"integer":{e.type="integer";break}case"ipv4":{e.format="ipv4";break}case"ipv6":{e.format="ipv6";break}case"iso_date":{e.format="date";break}case"iso_date_time":case"iso_timestamp":{e.format="date-time";break}case"iso_time":{e.format="time";break}case"length":{e.type==="array"?(e.minItems=r.requirement,e.maxItems=r.requirement):(e.type!=="string"&&(i=y(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement,e.maxLength=r.requirement);break}case"max_entries":{e.maxProperties=r.requirement;break}case"max_length":{e.type==="array"?e.maxItems=r.requirement:(e.type!=="string"&&(i=y(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=r.requirement);break}case"max_value":{e.type!=="number"&&(i=y(i,`The "max_value" action is not supported on type "${e.type}".`)),e.maximum=r.requirement;break}case"metadata":{typeof r.metadata.title=="string"&&(e.title=r.metadata.title),typeof r.metadata.description=="string"&&(e.description=r.metadata.description),Array.isArray(r.metadata.examples)&&(e.examples=r.metadata.examples);break}case"min_entries":{e.minProperties=r.requirement;break}case"min_length":{e.type==="array"?e.minItems=r.requirement:(e.type!=="string"&&(i=y(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement);break}case"min_value":{e.type!=="number"&&(i=y(i,`The "min_value" action is not supported on type "${e.type}".`)),e.minimum=r.requirement;break}case"multiple_of":{e.multipleOf=r.requirement;break}case"non_empty":{e.type==="array"?e.minItems=1:(e.type!=="string"&&(i=y(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=1);break}case"regex":{r.requirement.flags&&(i=y(i,"RegExp flags are not supported by JSON Schema.")),e.pattern=r.requirement.source;break}case"title":{e.title=r.title;break}case"url":{e.format="uri";break}case"uuid":{e.format="uuid";break}case"value":{e.const=r.requirement;break}default:i=y(i,`The "${r.type}" action cannot be converted to JSON Schema.`)}if(t?.overrideAction){const s=t.overrideAction({valibotAction:r,jsonSchema:e,errors:i});if(s)return{...s}}if(i)for(const s of i)h(s,t);return e}function J(e){return e.flatMap(r=>"pipe"in r?J(r.pipe):r)}let we=0;function o(e,r,t,i,s=!1){if(!s){const n=i.referenceMap.get(r);if(n){if(e.$ref=`#/$defs/${n}`,t?.overrideRef){const a=t.overrideRef({...i,referenceId:n,valibotSchema:r,jsonSchema:e});a&&(e.$ref=a)}return e}}if("pipe"in r){const n=J(r.pipe);let a=0,p=n.length-1;if(t?.typeMode==="input"){const l=n.slice(1).findIndex(f=>f.kind==="schema"||f.kind==="transformation"&&(f.type==="find_item"||f.type==="parse_json"||f.type==="raw_transform"||f.type==="reduce_items"||f.type==="stringify_json"||f.type==="transform"));l!==-1&&(p=l)}else if(t?.typeMode==="output"){const l=n.findLastIndex(f=>f.kind==="schema");l!==-1&&(a=l)}for(let l=a;l<=p;l++){const f=n[l];f.kind==="schema"?(l>a&&h('Set the "typeMode" config to "input" or "output" to convert pipelines with multiple schemas.',t),e=o(e,f,t,i,!0)):e=$e(e,f,t)}return e}let u;switch(r.type){case"boolean":{e.type="boolean";break}case"null":{e.type="null";break}case"number":{e.type="number";break}case"string":{e.type="string";break}case"array":{e.type="array",e.items=o({},r.item,t,i);break}case"tuple":case"tuple_with_rest":case"loose_tuple":case"strict_tuple":{e.type="array",e.items=[],e.minItems=r.items.length;for(const n of r.items)e.items.push(o({},n,t,i));r.type==="tuple_with_rest"?e.additionalItems=o({},r.rest,t,i):r.type==="strict_tuple"&&(e.additionalItems=!1);break}case"object":case"object_with_rest":case"loose_object":case"strict_object":{e.type="object",e.properties={},e.required=[];for(const n in r.entries){const a=r.entries[n];e.properties[n]=o({},a,t,i),a.type!=="nullish"&&a.type!=="optional"&&e.required.push(n)}r.type==="object_with_rest"?e.additionalProperties=o({},r.rest,t,i):r.type==="strict_object"&&(e.additionalProperties=!1);break}case"record":{"pipe"in r.key&&(u=y(u,'The "record" schema with a schema for the key that contains a "pipe" cannot be converted to JSON Schema.')),r.key.type!=="string"&&(u=y(u,`The "record" schema with the "${r.key.type}" schema for the key cannot be converted to JSON Schema.`)),e.type="object",e.additionalProperties=o({},r.value,t,i);break}case"any":case"unknown":break;case"nullable":case"nullish":{e.anyOf=[o({},r.wrapped,t,i),{type:"null"}],r.default!==void 0&&(e.default=b(r));break}case"exact_optional":case"optional":case"undefinedable":{e=o(e,r.wrapped,t,i),r.default!==void 0&&(e.default=b(r));break}case"literal":{typeof r.literal!="boolean"&&typeof r.literal!="number"&&typeof r.literal!="string"&&(u=y(u,'The value of the "literal" schema is not JSON compatible.')),e.const=r.literal;break}case"enum":{e.enum=r.options;break}case"picklist":{r.options.some(n=>typeof n!="number"&&typeof n!="string")&&(u=y(u,'An option of the "picklist" schema is not JSON compatible.')),e.enum=r.options;break}case"union":case"variant":{e.anyOf=r.options.map(n=>o({},n,t,i));break}case"intersect":{e.allOf=r.options.map(n=>o({},n,t,i));break}case"lazy":{let n=i.getterMap.get(r.getter);n||(n=r.getter(void 0),i.getterMap.set(r.getter,n));let a=i.referenceMap.get(n);if(a||(a=`${we++}`,i.referenceMap.set(n,a),i.definitions[a]=o({},n,t,i,!0)),e.$ref=`#/$defs/${a}`,t?.overrideRef){const p=t.overrideRef({...i,referenceId:a,valibotSchema:n,jsonSchema:e});p&&(e.$ref=p)}break}default:u=y(u,`The "${r.type}" schema cannot be converted to JSON Schema.`)}if(t?.overrideSchema){const n=t.overrideSchema({...i,referenceId:i.referenceMap.get(r),valibotSchema:r,jsonSchema:e,errors:u});if(n)return{...n}}if(u)for(const n of u)h(n,t);return e}let ve;function he(){return ve}function Ee(e,r){const t={definitions:{},referenceMap:new Map,getterMap:new Map},i=r?.definitions??he();if(i){for(const u in i)t.referenceMap.set(i[u],u);for(const u in i)t.definitions[u]=o({},i[u],r,t,!0)}const s=o({$schema:"http://json-schema.org/draft-07/schema#"},e,r,t);return t.referenceMap.size&&(s.$defs=t.definitions),s}function Oe({createFormValidator:e}){return r=>{const t=ye(),i=Ee(r,{overrideSchema:t.register,typeMode:"input"});return{schemaRegistry:t,schema:i,validator:e(t)}}}function xe(e){return(r={})=>_e(Object.setPrototypeOf({schemaRegistry:e},r))}const Ie=Oe({createFormValidator:xe}),qe=Ie;var Me=z("<!> <pre> </pre>",1);function Ke(e,r){L(r,!0);const t=R({id:g(k(v(),N(new RegExp("^\\d+$"),"Must be a number"),m(8))),active:g(F()),skills:g(k(w(k(v(),m(5))),m(4))),multipleChoicesList:g(k(w(T(["foo","bar","fuzz"])),V(2)))}),i=A({...S,...qe(t),uiSchema:re,fieldsValidationMode:W|X|Z,initialValue:ee});var s=Me(),u=C(s);j(u,{get form(){return i},novalidate:!0});var n=H(u,2),a=U(n,!0);K(n),G(p=>Y(a,p),[()=>JSON.stringify(Q(i),null,2)]),D(e,s),B()}export{Ke as default};
