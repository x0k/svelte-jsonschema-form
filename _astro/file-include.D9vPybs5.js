import{a5 as E,p as I,n as R,_ as C,o as y,$ as U,a6 as W,a7 as k,y as O,a1 as H,a3 as M,a4 as V}from"./definitions.Bik0brBO.js";import"./each.BS1Nmpei.js";import{p as j,m,d as p,b as v,a as q,g as o,u as l,n as z}from"./render.DluQIh46.js";import{s as G}from"./snippet.D9FB3COm.js";import{d as J,f as K}from"./file.qC8xSNCB.js";async function T(u,e,c,i){const{name:t,blob:s}=await u[E](e,i);c.items.add(new File([s],t,{type:s.type}))}function te(u,e,c,i){const t=[];for(const s of i)t.push(T(u,e,c,s));return Promise.all(t)}const N="fileField";function Q(u,e){j(e,!0);const c=a=>{var n=m(),r=p(n);G(r,()=>o(_)??z,()=>t,()=>e.config,()=>({get current(){return i()},set current(f){i(f)}}),()=>o(g)),v(a,n)};let i=I(e,"value",15);const t=R(),s=l(()=>O(t,"fieldTemplate",e.config)),F="fileWidget",L=l(()=>O(t,F,e.config)),A=C(t,()=>e.config,()=>U(t,e.config,i())),d=J({initialOutput:void 0,getInput:()=>i(),setInput:a=>i(a),async toOutput(a,n){const r=new DataTransfer;return n&&await T(t,a,r,n),r.files},async toInput(a,n){if(n===void 0||n.length===0)return;const r=n[0];if(!await W(a,t,e.config,n))throw new k;return K(a,r)}}),g=l(()=>H(t,e.config.path)),_=l(()=>M(t,e.config,N));var h=m(),b=p(h);{let a=l(()=>o(_)&&c);y(b,()=>o(s),(n,r)=>{r(n,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return e.uiOption},widgetType:F,get value(){return i()},get config(){return e.config},get errors(){return o(g)},get action(){return o(a)},children:(f,S)=>{var w=m(),P=p(w);y(P,()=>o(L),(x,B)=>{B(x,{type:"widget",get processing(){return d.inputProcessing},get loading(){return d.outputProcessing},get uiOption(){return e.uiOption},get handlers(){return A},get errors(){return o(g)},get config(){return e.config},multiple:!1,get value(){return d.current},set value(D){d.current=D}})}),v(f,w)},$$slots:{default:!0}})})}v(u,h),q()}V.fileField=Q;export{te as a};
