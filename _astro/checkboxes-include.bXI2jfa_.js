import{b as Y,c as oe}from"./assert.ZDHiudsA.js";import{ad as h,al as se,am as ce,an as ue,ao as N,ap as le,aq as fe,ar as de,as as U,P as me,at as pe,au as ge,av as be,aw as ve,ae as ye,af as W,ag as G,R as _e,ax as Ae,p as S,m as C,_ as Fe,n as B,$ as he,a0 as Se,a1 as Oe,x as H,a2 as Ee,a3 as Re,s as xe,r as Te,a4 as we}from"./definitions.Ba1XsyYK.js";import{e as ke}from"./each.C_j-bgU5.js";import{p as O,m as w,d as k,b as A,a as E,g as p,u as _,n as Ve,f as L,a_ as Ce,c as Me,s as Pe,r as De,t as Le,e as Ie}from"./render.BriTjfDz.js";import{s as je}from"./snippet.1bGkIM3E.js";import{c as Ne,g as Ue,b as I}from"./file.Ceea2C9B.js";import{b as We,u as Be,j,x as He,i as K,f as Ye,m as Ge,g as Ke}from"./en.BclwPTUR.js";function V(e,t,n={type:"root",path:[]}){if(!h(e))return t(e,n);const a={...e};for(const i of se){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:n.path.concat(i,0)};a[i]=c.map((f,u)=>(o.index=u,o.path[o.path.length-1]=u,V(f,t,o)))}const r=new Map;for(const i of ce){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:n.path.concat(i,"")},f=Object.keys(c),u=f.length;for(let d=0;d<u;d++){const m=f[d],g=c[m];if(Array.isArray(g)){r.set(m,g);continue}o.property=m,o.path[o.path.length-1]=m,r.set(m,V(g,t,o))}a[i]=Object.fromEntries(r),r.clear()}const s={type:"sub",parent:e,key:"items",path:n.path.concat("")};for(const i of ue){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,a[i]=V(c,t,s))}return t(a,n)}function qe(e,t){return V(e,n=>{if(!h(n))return n;const a=n[N];return a!==void 0&&a.startsWith("#")&&(n[N]=`${t}${a}`),n})}function q(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function St(e){if(e==="#")return[];const t=q(e);let n=!1;return t.map(a=>{if(n){const r=Number(a);if(Number.isInteger(r)&&r>=0)return n=!1,r}return n=le.has(a),a})}function ze(e,t){const n=[];if(e==="")return n;const a=q(e);let r=t;for(const s of a)if(Array.isArray(r)&&/^\d+$/.test(s)){const i=Number(s);n.push(i),r=r[i]}else n.push(s),r=r?.[s];return n}function Ot(e,t,n,a,r,s){function i(o,f,u,d){const m=o.map(v=>typeof v=="boolean"?v?{}:{not:{}}:v),g=pe(e,t,n,d,m,-1,ge(f)),b=c(m[g],u,d);if(b!==void 0)return b;let l;for(const v of m){if(!h(v))continue;const y=c(v,u,d);if(y!==void 0){if(h(y))return y;l=y}}return l}function c(o,f,u){for(let d=0;d<f.length;d++){if(o===void 0||!h(o))return;if(o.$ref)return c(fe(o.$ref,n),f.slice(d),u);if(o.allOf){const l=t.mergeAllOf(o);if(!l.allOf)return c(l,f.slice(d),u)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const l=i(m,o,f.slice(d),u);if(l!==void 0)return l}const g=f[d],b=typeof g;if(b==="number"){const{items:l,additionalItems:v}=o;o=(Array.isArray(l)?l[g]:l)??v,u=de(u)?u[g]:void 0;continue}if(b==="string"){const{properties:l,patternProperties:v,additionalProperties:y,dependencies:M,then:F,else:R}=o;o=(l&&l[g])??(v&&Object.entries(v).find(([P])=>new RegExp(P).test(g))?.[1])??y??(M&&i(Object.values(M).filter(U),o,f.slice(d),u))??((F||R)&&i([F,R].filter(U),o,f.slice(d),u)),u=me(u)?u[g]:void 0;continue}return}return o}return c(a,r,s)}const Xe={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},Je=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,Qe=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function Ze(e){return e.addFormat("color",Je),e.addFormat(ve,Qe),e}function $e(e){return e.addKeyword(be),e}function et(e){return $e(Ze(e))}function D(e,t){let n="",a=!1;const r=new WeakMap,s=G(r,i=>{let c=i;return a&&(c=qe(i,n),delete c[W]),e.compile(c)});return(i,c)=>{n=c[W]??ye;let o=e.getSchema(n)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(n),r.delete(i),o=void 0),o===void 0&&e.addSchema(c,n),a=i!==c,s(i)}}function z(e,t){const a=G(new WeakMap,r=>e.compile({...r,$async:t}));return r=>a(r.schema)}function tt({params:{missingProperty:e,propertyName:t},propertyName:n=t},a){let r=a;return r=e!==void 0?a.concat(e):r,r=n!==void 0?a.concat(n,_e("key-input")):r,r}function X({params:{missingProperty:e},parentSchema:t,message:n},a){if(!n)return"";if(e===void 0)return n;const r=a(e,t);return r===void 0?n:n.replace(e,r)}function J({uiSchema:e={}}){return(t,n)=>({value:n,errors:t.map(a=>{const r=ze(a.instancePath,n);return{path:tt(a,r),message:X(a,(s,i)=>{const c=Ae(e,r.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function Q(e){return e.instancePath===""}function nt(e){return Q(e)&&e.keyword!=="type"}function Z(e){return t=>t.filter(e.required?Q:nt).map(n=>X(n,()=>e.title))}function $(e,t,n,a){e(t);const r=e.errors;return e.errors=null,r?a(r,t):n(t)}async function ee(e,t,n,a){try{await e(t)}catch(r){if(!(r instanceof Y.Ajv.ValidationError))throw r;return a(r.errors,t)}finally{e.errors=null}return n(t)}const te=e=>({value:e}),ne=()=>[];function re({compileSchema:e}){return{isValid(t,n,a){if(typeof t=="boolean")return t;const r=e(t,n);try{return r(a)}catch(s){return console.warn("Failed to validate",s),!1}}}}function rt(e){const t=J(e);return{validateFormValue(n,a){return $(e.compileSchema(n,n),a,te,t)}}}function at({compileFieldSchema:e}){return{validateFieldValue(t,n){return $(e(t),n,ne,Z(t))}}}function it(e){const t=J(e);return{async validateFormValueAsync(n,a,r){return ee(e.compileAsyncSchema(a,a),r,te,t)}}}function ot({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,n,a){return ee(e(n),a,ne,Z(n))}}}function Et({ajvOptions:e=Xe,ajvPlugins:t=et,ajv:n=t(new Y.Ajv(e)),compileSchema:a=D(n),compileFieldSchema:r=z(n,!1),...s}={}){const i={...s,compileSchema:a,compileFieldSchema:r};return Object.assign(re(i),rt(i),at(i))}function Rt({ajv:e,compileSchema:t=D(e),compileAsyncSchema:n=D(e),compileAsyncFieldSchema:a=z(e,!0),...r}){const s={...r,compileSchema:t,compileAsyncSchema:n,compileAsyncFieldSchema:a};return Object.assign(re(s),it(s),ot(s))}const st="nativeFileField";function ct(e,t){O(t,!0);const n=b=>{var l=w(),v=k(l);je(v,()=>p(d)??Ve,()=>r,()=>t.config,()=>({get current(){return a()},set current(y){a(y)}}),()=>p(f)),A(b,l)};let a=S(t,"value",15);const r=C(),s=_(()=>H(r,"fieldTemplate",t.config)),i="fileWidget",c=_(()=>H(r,i,t.config)),o=Fe(r,()=>t.config,()=>he(r,t.config,a())),f=_(()=>Ee(r,t.config.path)),u=Ne({combinator:Ue,async execute(b,l){if(!(l===void 0||l.length===0)){if(!await Se(b,r,t.config,l))throw new Oe;return l[0]}},onSuccess(b){a(b)}}),d=_(()=>Re(r,t.config,st));var m=w(),g=k(m);{let b=_(()=>p(d)&&n);B(g,()=>p(s),(l,v)=>{v(l,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return a()},get config(){return t.config},get errors(){return p(f)},get action(){return p(b)},children:(y,M)=>{var F=w(),R=k(F),P=()=>{const x=a(),T=new DataTransfer;return x&&T.items.add(x),T.files},ae=u.run;B(R,()=>p(c),(x,T)=>{T(x,{type:"widget",get value(){return P()},set value(ie){ae(ie)},get processing(){return u.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return p(f)},get config(){return t.config},multiple:!1})}),A(y,F)},$$slots:{default:!0}})})}A(e,m),E()}function ut(e,t){O(t,!0);let n=S(t,"value",15),a=Te(t,["$$slots","$$events","$$legacy","value"]);var r=()=>(oe(n()),n()),s=i=>{n(i)};ct(e,xe({get value(){return r()},set value(i){s(i)}},()=>a)),E()}we.unknownNativeFileField=ut;var lt=L("<textarea></textarea>");function ft(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>Be(a,t.config,"textarea",t.handlers,{class:"sjsf-textarea"}));var s=lt();Ce(s),I(s,()=>({...p(r)})),We(s,n),A(e,s),E()}j.textareaWidget=ft;var dt=L("<input/>");function mt(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>K(a,t.config,"file",t.handlers,{multiple:t.multiple,class:"sjsf-file","data-loading":t.loading,"data-processing":t.processing}));var s=dt();I(s,()=>({type:"file",...p(r)}),void 0,void 0,void 0,void 0,!0),He(s,n),A(e,s),E()}j.fileWidget=mt;var pt=L('<label class="sjsf-checkboxes"><input/> </label>');function gt(e,t){O(t,!0);const n=[];let a=S(t,"value",15);const r=C(),s=_(()=>K(r,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=Ge({mapper:()=>Ke(t.options),value:()=>a(),update:f=>a(f)});var c=w(),o=k(c);ke(o,17,()=>t.options,f=>f.id,(f,u)=>{var d=pt(),m=Me(d);I(m,()=>({value:p(u).id,...p(s),id:p(u).id,disabled:p(u).disabled||p(s).disabled}),void 0,void 0,void 0,void 0,!0);var g=Pe(m);De(d),Le(()=>Ie(g,` ${p(u).label??""}`)),Ye(n,[],m,()=>(p(u).id,i.value),b=>i.value=b),A(f,d)}),A(e,c),E()}j.checkboxesWidget=gt;export{te as C,ne as N,et as a,Rt as b,Et as c,St as d,J as e,Z as f,Ot as g,qe as h,ze as p,$ as v};
