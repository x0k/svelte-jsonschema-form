import{ad as h,am as ie,an as oe,ao as se,ap as N,aq as ce,ar as ue,as as le,at as U,R as fe,au as de,av as me,p as S,l as C,V as pe,m as W,W as ge,a7 as be,a8 as ye,x as B,Z as ve,_ as _e,s as Ae,r as Fe,$ as he,aw as Se,ax as Oe,ah as Ee,ai as H,aj as Re,ak as xe,U as Te,ay as we}from"./definitions.xTkvThOi.js";import{e as ke}from"./each.tP9HQ3PH.js";import{p as O,m as w,e as k,b as A,a as E,g,u as _,o as Ve,b3 as Ce,f as L,c as Me,s as Pe,r as De,t as Le,h as je}from"./render.BLPiGEwN.js";import{b as Ie,c as Y}from"./ajv.D2n6zvV_.js";import{s as Ne}from"./snippet.DY9HY_LV.js";import{c as Ue,g as We,b as j}from"./file.Bq96V3Fo.js";import{b as Be,u as He,j as I,w as Ye,i as z,f as ze,m as Ge,g as Ke}from"./en.azFuuGpD.js";function V(e,t,r={type:"root",path:[]}){if(!h(e))return t(e,r);const n={...e};for(const i of ie){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:r.path.concat(i,0)};n[i]=c.map((f,u)=>(o.index=u,o.path[o.path.length-1]=u,V(f,t,o)))}const a=new Map;for(const i of oe){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:r.path.concat(i,"")},f=Object.keys(c),u=f.length;for(let d=0;d<u;d++){const m=f[d],b=c[m];if(Array.isArray(b)){a.set(m,b);continue}o.property=m,o.path[o.path.length-1]=m,a.set(m,V(b,t,o))}n[i]=Object.fromEntries(a),a.clear()}const s={type:"sub",parent:e,key:"items",path:r.path.concat("")};for(const i of se){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,n[i]=V(c,t,s))}return t(n,r)}function qe(e,t){return V(e,r=>{if(!h(r))return r;const n=r[N];return n!==void 0&&n.startsWith("#")&&(r[N]=`${t}${n}`),r})}function G(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function Ot(e){if(e==="#")return[];const t=G(e);let r=!1;return t.map(n=>{if(r){const a=Number(n);if(Number.isInteger(a)&&a>=0)return r=!1,a}return r=ce.has(n),n})}function Xe(e,t){const r=[];if(e==="")return r;const n=G(e);let a=t;for(const s of n)if(Array.isArray(a)&&/^\d+$/.test(s)){const i=Number(s);r.push(i),a=a[i]}else r.push(s),a=a?.[s];return r}function Et(e,t,r,n,a,s){function i(o,f,u,d){const m=o.map(p=>typeof p=="boolean"?p?{}:{not:{}}:p),b=de(e,t,r,d,m,-1,me(f)),y=c(m[b],u,d);if(y!==void 0)return y;let l;for(const p of m){if(!h(p))continue;const v=c(p,u,d);if(v!==void 0){if(h(v))return v;l=v}}return l}function c(o,f,u){for(let d=0;d<f.length;d++){if(o===void 0||!h(o))return;if(o.$ref)return c(ue(o.$ref,r),f.slice(d),u);if(o.allOf){const l=t.mergeAllOf(o);if(!l.allOf)return c(l,f.slice(d),u)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const l=i(m,o,f.slice(d),u);if(l!==void 0)return l}const b=f[d],y=typeof b;if(y==="number"){const{items:l,additionalItems:p}=o;o=(Array.isArray(l)?l[b]:l)??p,u=le(u)?u[b]:void 0;continue}if(y==="string"){const{properties:l,patternProperties:p,additionalProperties:v,dependencies:M,then:F,else:R}=o;o=(l&&l[b])??(p&&Object.entries(p).find(([P])=>new RegExp(P).test(b))?.[1])??v??(M&&i(Object.values(M).filter(U),o,f.slice(d),u))??((F||R)&&i([F,R].filter(U),o,f.slice(d),u)),u=fe(u)?u[b]:void 0;continue}return}return o}return c(n,a,s)}const Je="nativeFileField";function Ze(e,t){O(t,!0);const r=y=>{var l=w(),p=k(l);Ne(p,()=>g(d)??Ve,()=>a,()=>t.config,()=>({get current(){return n()},set current(v){n(v)}}),()=>g(f)),A(y,l)};let n=S(t,"value",15);const a=C(),s=_(()=>B(a,"fieldTemplate",t.config)),i="fileWidget",c=_(()=>B(a,i,t.config)),o=pe(a,()=>t.config,()=>ge(a,t.config,n())),f=_(()=>ve(a,t.config.path)),u=Ue({combinator:We,async execute(y,l){if(l===void 0||l.length===0)return;const p=l[0];if(!await be(y,a,t.config,l))throw new ye;return p},onSuccess(y){n(y)}}),d=_(()=>_e(a,t.config,Je));var m=w(),b=k(m);{let y=_(()=>g(d)&&r);W(b,()=>g(s),(l,p)=>{p(l,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return n()},get config(){return t.config},get errors(){return g(f)},get action(){return g(y)},children:(v,M)=>{var F=w(),R=k(F),P=()=>{const x=n(),T=new DataTransfer;return x&&T.items.add(x),T.files},ne=u.run;W(R,()=>g(c),(x,T)=>{T(x,{type:"widget",get value(){return P()},set value(ae){ne(ae)},get processing(){return u.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return g(f)},get config(){return t.config},multiple:!1})}),A(v,F)},$$slots:{default:!0}})})}A(e,m),E()}function Qe(e,t){O(t,!0);let r=S(t,"value",15),n=Fe(t,["$$slots","$$events","$$legacy","value"]);var a=()=>(Ie(r()),r()),s=i=>{r(i)};Ze(e,Ae({get value(){return a()},set value(i){s(i)}},()=>n)),E()}he.unknownNativeFileField=Qe;var $e=L("<textarea></textarea>");function et(e,t){O(t,!0);let r=S(t,"value",15);const n=C(),a=_(()=>He(n,t.config,"textarea",t.handlers,{class:"sjsf-textarea"}));var s=$e();Ce(s),j(s,()=>({...g(a)})),Be(s,r),A(e,s),E()}I.textareaWidget=et;var tt=L("<input/>");function rt(e,t){O(t,!0);let r=S(t,"value",15);const n=C(),a=_(()=>z(n,t.config,"file",t.handlers,{multiple:t.multiple,class:"sjsf-file","data-loading":t.loading,"data-processing":t.processing}));var s=tt();j(s,()=>({type:"file",...g(a)}),void 0,void 0,void 0,void 0,!0),Ye(s,r),A(e,s),E()}I.fileWidget=rt;var nt=L('<label class="sjsf-checkboxes"><input/> </label>');function at(e,t){O(t,!0);const r=[];let n=S(t,"value",15);const a=C(),s=_(()=>z(a,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=Ge({mapper:()=>Ke(t.options),value:()=>n(),update:f=>n(f)});var c=w(),o=k(c);ke(o,17,()=>t.options,f=>f.id,(f,u)=>{var d=nt(),m=Me(d);j(m,()=>({value:g(u).id,...g(s),id:g(u).id,disabled:g(u).disabled||g(s).disabled}),void 0,void 0,void 0,void 0,!0);var b=Pe(m);De(d),Le(()=>je(b,` ${g(u).label??""}`)),ze(r,[],m,()=>(g(u).id,i.current),y=>i.current=y),A(f,d)}),A(e,c),E()}I.checkboxesWidget=at;const it={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},ot=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,st=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function ct(e){return e.addFormat("color",ot),e.addFormat(Oe,st),e}function ut(e){return e.addKeyword(Se),e}function lt(e){return ut(ct(e))}function D(e,t,r=new WeakMap){let n="",a=!1;const s=Re(r,i=>{let c=i;return a&&(c=qe(i,n),delete c[H]),e.compile(c)});return(i,c)=>{n=c[H]??Ee;let o=e.getSchema(n)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(n),r.delete(i),o=void 0),o===void 0&&e.addSchema(c,n),a=i!==c,s(i)}}function K(e,t){const n=xe(new WeakMap,a=>e.compile({...a,$async:t}));return a=>n(a.schema)}function ft({params:{missingProperty:e,propertyName:t},propertyName:r=t},n){let a=n;return a=e!==void 0?n.concat(e):a,a=r!==void 0?n.concat(r,Te("key-input")):a,a}function q({params:{missingProperty:e},parentSchema:t,message:r},n){if(!r)return"";if(e===void 0)return r;const a=n(e,t);return a===void 0?r:r.replace(e,a)}function X({uiSchema:e={}}){return(t,r)=>({value:r,errors:t.map(n=>{const a=Xe(n.instancePath,r);return{path:ft(n,a),message:q(n,(s,i)=>{const c=we(e,a.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function J(e){return e.instancePath===""}function dt(e){return J(e)&&e.keyword!=="type"}function Z(e){return t=>t.filter(e.required?J:dt).map(r=>q(r,()=>e.title))}function Q(e,t,r,n){e(t);const a=e.errors;return e.errors=null,a?n(a,t):r(t)}async function $(e,t,r,n){try{await e(t)}catch(a){if(!(a instanceof Y.Ajv.ValidationError))throw a;return n(a.errors,t)}finally{e.errors=null}return r(t)}const ee=e=>({value:e}),te=()=>[];function re({compileSchema:e}){return{isValid(t,r,n){if(typeof t=="boolean")return t;const a=e(t,r);try{return a(n)}catch(s){return console.warn("Failed to validate",s),!1}}}}function mt(e){const t=X(e);return{validateFormValue(r,n){return Q(e.compileSchema(r,r),n,ee,t)}}}function pt({compileFieldSchema:e}){return{validateFieldValue(t,r){return Q(e(t),r,te,Z(t))}}}function gt(e){const t=X(e);return{async validateFormValueAsync(r,n,a){return $(e.compileAsyncSchema(n,n),a,ee,t)}}}function bt({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,r,n){return $(e(r),n,te,Z(r))}}}function Rt({ajvOptions:e=it,ajvPlugins:t=lt,ajv:r=t(new Y.Ajv(e)),validatorsCache:n,compileSchema:a=D(r,!1,n),compileFieldSchema:s=K(r,!1),...i}={}){const c={...i,compileSchema:a,compileFieldSchema:s};return Object.assign(re(c),mt(c),pt(c))}function xt({ajv:e,validatorsCache:t,compileSchema:r=D(e,!1,t),compileAsyncSchema:n=D(e,!0,t),compileAsyncFieldSchema:a=K(e,!0),...s}){const i={...s,compileSchema:r,compileAsyncSchema:n,compileAsyncFieldSchema:a};return Object.assign(re(i),gt(i),bt(i))}export{ee as C,te as N,lt as a,xt as b,Rt as c,Ot as d,X as e,Z as f,Et as g,qe as h,Xe as p,Q as v};
