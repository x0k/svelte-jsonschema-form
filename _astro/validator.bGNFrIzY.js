import{ad as h,am as ie,an as oe,ao as se,ap as N,aq as ce,ar as ue,as as le,at as U,R as fe,au as de,av as me,p as S,m as C,V as pe,n as W,W as ge,a7 as be,a8 as ye,y as B,Z as _e,_ as ve,s as Ae,r as Fe,$ as he,aw as Se,ax as Oe,ae as Ee,af as H,ag as Re,ah as Te,U as we,ay as xe}from"./definitions.CJzjw8-U.js";import{e as ke}from"./each.Cjw3fkz9.js";import{p as O,l as x,d as k,b as A,a as E,g,u as v,o as Ve,a_ as Ce,f as L,c as Me,s as Pe,r as De,t as Le,e as Ie}from"./render.bjje8vhp.js";import{b as je,c as Y}from"./ajv.Cz3gIrXa.js";import{s as Ne}from"./snippet.nY02T5g5.js";import{c as Ue,g as We,b as I}from"./file.CnZAx8ju.js";import{b as Be,u as He,j,w as Ye,i as z,f as ze,m as Ge,g as Ke}from"./en.CX3scg-q.js";function V(e,t,n={type:"root",path:[]}){if(!h(e))return t(e,n);const r={...e};for(const i of ie){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:n.path.concat(i,0)};r[i]=c.map((f,u)=>(o.index=u,o.path[o.path.length-1]=u,V(f,t,o)))}const a=new Map;for(const i of oe){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:n.path.concat(i,"")},f=Object.keys(c),u=f.length;for(let d=0;d<u;d++){const m=f[d],b=c[m];if(Array.isArray(b)){a.set(m,b);continue}o.property=m,o.path[o.path.length-1]=m,a.set(m,V(b,t,o))}r[i]=Object.fromEntries(a),a.clear()}const s={type:"sub",parent:e,key:"items",path:n.path.concat("")};for(const i of se){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,r[i]=V(c,t,s))}return t(r,n)}function qe(e,t){return V(e,n=>{if(!h(n))return n;const r=n[N];return r!==void 0&&r.startsWith("#")&&(n[N]=`${t}${r}`),n})}function G(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function Ot(e){if(e==="#")return[];const t=G(e);let n=!1;return t.map(r=>{if(n){const a=Number(r);if(Number.isInteger(a)&&a>=0)return n=!1,a}return n=ce.has(r),r})}function Xe(e,t){const n=[];if(e==="")return n;const r=G(e);let a=t;for(const s of r)if(Array.isArray(a)&&/^\d+$/.test(s)){const i=Number(s);n.push(i),a=a[i]}else n.push(s),a=a?.[s];return n}function Et(e,t,n,r,a,s){function i(o,f,u,d){const m=o.map(p=>typeof p=="boolean"?p?{}:{not:{}}:p),b=de(e,t,n,d,m,-1,me(f)),y=c(m[b],u,d);if(y!==void 0)return y;let l;for(const p of m){if(!h(p))continue;const _=c(p,u,d);if(_!==void 0){if(h(_))return _;l=_}}return l}function c(o,f,u){for(let d=0;d<f.length;d++){if(o===void 0||!h(o))return;if(o.$ref)return c(ue(o.$ref,n),f.slice(d),u);if(o.allOf){const l=t.mergeAllOf(o);if(!l.allOf)return c(l,f.slice(d),u)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const l=i(m,o,f.slice(d),u);if(l!==void 0)return l}const b=f[d],y=typeof b;if(y==="number"){const{items:l,additionalItems:p}=o;o=(Array.isArray(l)?l[b]:l)??p,u=le(u)?u[b]:void 0;continue}if(y==="string"){const{properties:l,patternProperties:p,additionalProperties:_,dependencies:M,then:F,else:R}=o;o=(l&&l[b])??(p&&Object.entries(p).find(([P])=>new RegExp(P).test(b))?.[1])??_??(M&&i(Object.values(M).filter(U),o,f.slice(d),u))??((F||R)&&i([F,R].filter(U),o,f.slice(d),u)),u=fe(u)?u[b]:void 0;continue}return}return o}return c(r,a,s)}const Je="nativeFileField";function Ze(e,t){O(t,!0);const n=y=>{var l=x(),p=k(l);Ne(p,()=>g(d)??Ve,()=>a,()=>t.config,()=>({get current(){return r()},set current(_){r(_)}}),()=>g(f)),A(y,l)};let r=S(t,"value",15);const a=C(),s=v(()=>B(a,"fieldTemplate",t.config)),i="fileWidget",c=v(()=>B(a,i,t.config)),o=pe(a,()=>t.config,()=>ge(a,t.config,r())),f=v(()=>_e(a,t.config.path)),u=Ue({combinator:We,async execute(y,l){if(l===void 0||l.length===0)return;const p=l[0];if(!await be(y,a,t.config,l))throw new ye;return p},onSuccess(y){r(y)}}),d=v(()=>ve(a,t.config,Je));var m=x(),b=k(m);{let y=v(()=>g(d)&&n);W(b,()=>g(s),(l,p)=>{p(l,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return r()},get config(){return t.config},get errors(){return g(f)},get action(){return g(y)},children:(_,M)=>{var F=x(),R=k(F),P=()=>{const T=r(),w=new DataTransfer;return T&&w.items.add(T),w.files},re=u.run;W(R,()=>g(c),(T,w)=>{w(T,{type:"widget",get value(){return P()},set value(ae){re(ae)},get processing(){return u.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return g(f)},get config(){return t.config},multiple:!1})}),A(_,F)},$$slots:{default:!0}})})}A(e,m),E()}function Qe(e,t){O(t,!0);let n=S(t,"value",15),r=Fe(t,["$$slots","$$events","$$legacy","value"]);var a=()=>(je(n()),n()),s=i=>{n(i)};Ze(e,Ae({get value(){return a()},set value(i){s(i)}},()=>r)),E()}he.unknownNativeFileField=Qe;var $e=L("<textarea></textarea>");function et(e,t){O(t,!0);let n=S(t,"value",15);const r=C(),a=v(()=>He(r,t.config,"textarea",t.handlers,{class:"sjsf-textarea"}));var s=$e();Ce(s),I(s,()=>({...g(a)})),Be(s,n),A(e,s),E()}j.textareaWidget=et;var tt=L("<input/>");function nt(e,t){O(t,!0);let n=S(t,"value",15);const r=C(),a=v(()=>z(r,t.config,"file",t.handlers,{multiple:t.multiple,class:"sjsf-file","data-loading":t.loading,"data-processing":t.processing}));var s=tt();I(s,()=>({type:"file",...g(a)}),void 0,void 0,void 0,void 0,!0),Ye(s,n),A(e,s),E()}j.fileWidget=nt;var rt=L('<label class="sjsf-checkboxes"><input/> </label>');function at(e,t){O(t,!0);const n=[];let r=S(t,"value",15);const a=C(),s=v(()=>z(a,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=Ge({mapper:()=>Ke(t.options),value:()=>r(),update:f=>r(f)});var c=x(),o=k(c);ke(o,17,()=>t.options,f=>f.id,(f,u)=>{var d=rt(),m=Me(d);I(m,()=>({value:g(u).id,...g(s),id:g(u).id,disabled:g(u).disabled||g(s).disabled}),void 0,void 0,void 0,void 0,!0);var b=Pe(m);De(d),Le(()=>Ie(b,` ${g(u).label??""}`)),ze(n,[],m,()=>(g(u).id,i.current),y=>i.current=y),A(f,d)}),A(e,c),E()}j.checkboxesWidget=at;const it={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},ot=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,st=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function ct(e){return e.addFormat("color",ot),e.addFormat(Oe,st),e}function ut(e){return e.addKeyword(Se),e}function lt(e){return ut(ct(e))}function D(e,t,n=new WeakMap){let r="",a=!1;const s=Re(n,i=>{let c=i;return a&&(c=qe(i,r),delete c[H]),e.compile(c)});return(i,c)=>{r=c[H]??Ee;let o=e.getSchema(r)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(r),n.delete(i),o=void 0),o===void 0&&e.addSchema(c,r),a=i!==c,s(i)}}function K(e,t){const r=Te(new WeakMap,a=>e.compile({...a,$async:t}));return a=>r(a.schema)}function ft({params:{missingProperty:e,propertyName:t},propertyName:n=t},r){let a=r;return a=e!==void 0?r.concat(e):a,a=n!==void 0?r.concat(n,we("key-input")):a,a}function q({params:{missingProperty:e},parentSchema:t,message:n},r){if(!n)return"";if(e===void 0)return n;const a=r(e,t);return a===void 0?n:n.replace(e,a)}function X({uiSchema:e={}}){return(t,n)=>({value:n,errors:t.map(r=>{const a=Xe(r.instancePath,n);return{path:ft(r,a),message:q(r,(s,i)=>{const c=xe(e,a.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function J(e){return e.instancePath===""}function dt(e){return J(e)&&e.keyword!=="type"}function Z(e){return t=>t.filter(e.required?J:dt).map(n=>q(n,()=>e.title))}function Q(e,t,n,r){e(t);const a=e.errors;return e.errors=null,a?r(a,t):n(t)}async function $(e,t,n,r){try{await e(t)}catch(a){if(!(a instanceof Y.Ajv.ValidationError))throw a;return r(a.errors,t)}finally{e.errors=null}return n(t)}const ee=e=>({value:e}),te=()=>[];function ne({compileSchema:e}){return{isValid(t,n,r){if(typeof t=="boolean")return t;const a=e(t,n);try{return a(r)}catch(s){return console.warn("Failed to validate",s),!1}}}}function mt(e){const t=X(e);return{validateFormValue(n,r){return Q(e.compileSchema(n,n),r,ee,t)}}}function pt({compileFieldSchema:e}){return{validateFieldValue(t,n){return Q(e(t),n,te,Z(t))}}}function gt(e){const t=X(e);return{async validateFormValueAsync(n,r,a){return $(e.compileAsyncSchema(r,r),a,ee,t)}}}function bt({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,n,r){return $(e(n),r,te,Z(n))}}}function Rt({ajvOptions:e=it,ajvPlugins:t=lt,ajv:n=t(new Y.Ajv(e)),validatorsCache:r,compileSchema:a=D(n,!1,r),compileFieldSchema:s=K(n,!1),...i}={}){const c={...i,compileSchema:a,compileFieldSchema:s};return Object.assign(ne(c),mt(c),pt(c))}function Tt({ajv:e,validatorsCache:t,compileSchema:n=D(e,!1,t),compileAsyncSchema:r=D(e,!0,t),compileAsyncFieldSchema:a=K(e,!0),...s}){const i={...s,compileSchema:n,compileAsyncSchema:r,compileAsyncFieldSchema:a};return Object.assign(ne(i),gt(i),bt(i))}export{ee as C,te as N,lt as a,Tt as b,Rt as c,Ot as d,X as e,Z as f,Et as g,qe as h,Xe as p,Q as v};
