import{c as G}from"./schemas.BSJDjAC1.js";import"./assert.CKW2ctZP.js";import"./file-include.DF8SBP2h.js";import"./shared.DpxGDDmb.js";const L=(t,e)=>Array.from(new Array(t),(o,n)=>e(n));function j(t,e){for(let o=0;o<t.length;o++)t[o]+=e}function Q({rows:t,indexes:e},o){for(let n=0;n<t.length;n++){e[n]=e[n]*o;const i=t[n].cells;for(let r=0;r<i.length;r++)i[r].height=i[r].height*o}}function X({rows:t},e){for(let o=0;o<t.length;o++){const{cells:n,columns:i}=t[o];for(let r=0;r<n.length;r++)n[r].width=n[r].width*e,i[r]=i[r]*e}}const B=(t,e)=>t>e?t:e,b=(t,e)=>t?b(e%t,t):e,H=(t,e)=>t*e/b(t,e);function Y({blocks:t,width:e,heightIsLcm:o=!0,height:n,widthIsLcm:i=!0}){const r=t.map(l=>{const s=i?e/l.width:1,c=o?n/l.height:1,{rows:h,indexes:d}=l.data,u=L(n,()=>new Array(e));for(let w=0;w<h.length;w++){const p=d[w],{cells:k,columns:R}=h[w];for(let a=0;a<k.length;a++){const g=k[a],f=p*c;let m=f+g.height*c;!o&&m===l.height&&m<n&&(m=n);const x=R[a]*s;let I=x+g.width*s;!i&&I===l.width&&I<e&&(I=e);for(let y=f;y<m;y++){const P=u[y];for(let T=x;T<I;T++)P[T]=g}}}return u});for(let l=0;l<n;l++){const s=r[0][l];for(let c=0;c<e;c++){const h=s[c];for(let d=1;d<t.length;d++){const u=r[d][l][c];if(!u||h.value!==u.value)return!1}}l++}return!0}function K({rows:t},e,o){for(const[n,i]of e){const r=t[n].cells;for(const[l,s]of i)r[l][o]+=s}}function tt({data:t,height:e,width:o}){const n=L(o,()=>0),i=new Array(o),{rows:r}=t;for(let s=0;s<r.length;s++){const{cells:c,columns:h}=r[s];for(let d=0;d<c.length;d++){const u=c[d],w=h[d];n[w]+=u.height,i[w]={cell:u,rowIndex:s,colIndex:d};for(let p=1;p<u.width;p++)n[w+p]+=u.height,i[w+p]=null}}const l=new Map;for(let s=0;s<o;s++){const c=i[s];if(!c)continue;const h=e-n[s];if(h<=0)continue;const d=l.get(c.rowIndex)||new Map;l.set(c.rowIndex,d.set(c.colIndex,h))}K(t,l,"height")}function et({data:t,height:e,width:o}){const n=new Array(e),{rows:i,indexes:r}=t;for(let c=0;c<i.length;c++){const{cells:h,columns:d}=i[c];if(h.length===0)continue;const u=h.length-1,w=h[u],p=d[u]+w.width,k={cell:w,indexInRow:u,xTopRightCorner:p},R=r[c];for(let a=R;a<R+w.height;a++){const g=n[a];(!g||p>g.xTopRightCorner)&&(n[a]=k)}}const l=new Set,s=new Map;for(let c=0;c<i.length;c++){const h=r[c],d=n[h];if(!d||l.has(d.cell))continue;l.add(d.cell);const u=o-d.xTopRightCorner;if(u<=0)continue;const w=s.get(c)||new Map;s.set(c,w.set(d.indexInRow,u))}K(t,s,"width")}const nt={width:X,height:Q},ot={width:et,height:tt};function v(t,e){const o=nt[t],n=ot[t];return i=>{const r=Math.floor(e/i[t]);r>1&&o(i.data,r);let l=i[t];i[t]=e,e-l*r>0&&n(i)}}function M(t,e){const o=new Array(0),n=new Array(0);let i=0;for(let r=0;r<t.length;r++){const{data:l,height:s}=t[r];for(let c=0;c<l.rows.length;c++)n.push(i+l.indexes[c]),o.push(l.rows[c]);i+=s}return{width:e,height:i,data:{rows:o,indexes:n}}}function it(t){const e=new Array(t.length);let o=0;for(let n=0;n<t.length;n++){if(t[n].cells.length===0){o++;continue}t[n-o]=t[n],e[n-o]=n}return t.length-=o,e.length-=o,e}function W(t,e){const o=L(e,()=>({cells:[],columns:[]}));let n=0;for(let r=0;r<t.length;r++){const{data:{rows:l,indexes:s},width:c}=t[r];for(let h=0;h<l.length;h++){const{cells:d,columns:u}=l[h],w=o[s[h]];for(let p=0;p<d.length;p++)w.cells.push(d[p]),w.columns.push(u[p]+n)}n+=c}const i=it(o);return{width:n,height:e,data:{rows:o,indexes:i}}}function st(t){return function(o){let n=o[0].width,i=n;for(let s=1;s<o.length;s++){const c=o[s];n=H(n,c.width),i=B(i,c.width)}const r=t(n,i)?n:i,l=v("width",r);for(let s=0;s<o.length;s++)l(o[s]);return M(o,r)}}function rt(t){return e=>{let o=e[0].height,n=o;for(let l=1;l<e.length;l++)o=H(o,e[l].height),n=B(n,e[l].height);const i=t(o,n)?o:n,r=v("height",i);for(let l=0;l<e.length;l++)r(e[l]);return W(e,i)}}var E;(function(t){t.Header="header",t.Index="index",t.Value="value",t.Corner="corner"})(E||(E={}));const ct={head:"height",indexes:"width"},q={head:"indexes",indexes:"head"};function _(t){return{head:null,indexes:null,body:{height:1,width:1,data:{rows:[{cells:[{height:1,width:1,value:t,type:E.Value}],columns:[0]}],indexes:[0]}}}}function lt(t,e){return t.width===e.width?t.height<e.height?t:e:t.width>e.width?t:e}function ht(t,e){return t.height===e.height?t.width<e.width?t:e:t.height>e.height?t:e}const at={head:lt,indexes:ht};function dt(t,e,o){const{[e]:n}=t[0];if(!n)return null;const i=at[e],r=[n];let l=n,s=n.height,c=n.width,h=n.height,d=n.width;for(let p=1;p<t.length;p++){const k=t[p][e];if(!k)return null;l=i(l,k),h=B(h,k.height),d=B(d,k.width),s=H(s,k.height),c=H(c,k.width),r.push(k)}const u=o(s,h),w=o(c,d);return!(e==="head"?u:w)||!Y({blocks:r,width:w?c:d,widthIsLcm:w,height:u?s:h,heightIsLcm:u})?null:l}function D({head:t,indexes:e,cornerCellValue:o}){return({body:n,head:i,indexes:r})=>{if(!t&&!e)return n;const l=t&&i!==null,s=e&&r!==null,c=s?W([r,n],n.height):n,h=n.width+(s?r.width:0);if(!l)return c;if(!s)return M([i,c],h);for(let u=0;u<i.data.rows.length;u++)j(i.data.rows[u].columns,r.width);const d=i.data.rows[0];return d.cells.unshift({height:i.height,width:r.width,value:o,type:E.Corner}),d.columns.unshift(0),M([i,c],h)}}function ut(t,e,o,n){const i=[];for(let r=0;r<t.length;r++){const l=t[r],{[e]:s,[q[e]]:c}=l;if(s===null)return null;if(!o||!c){i.push(s);continue}switch(e){case"indexes":{const h=s.data.indexes.slice();j(h,c.height),h.unshift(0),i.push({height:s.height+c.height,width:s.width,data:{rows:[{cells:[{height:c.height,width:s.width,value:n,type:E.Corner}],columns:[0]},...s.data.rows],indexes:h}});break}case"head":{const h=s.data.rows[0].columns.slice();j(h,c.width),h.unshift(0),i.push({height:s.height,width:s.width+c.width,data:{rows:[{cells:[{height:s.height,width:c.width,value:n,type:E.Corner},...s.data.rows[0].cells],columns:h},...s.data.rows.slice(1)],indexes:s.data.indexes}});break}default:throw new Error(`Unknown table component: ${e}`)}}return i}const ft={head:st,indexes:rt};function F({deduplicationComponent:t,isProportionalResize:e,cornerCellValue:o}){const n=ft[t](e),i=q[t];return r=>{const l=dt(r,t,e),s=l===null,c=ut(r,i,s,o),h=r.map(D({[t]:s,[i]:c===null,cornerCellValue:o})),d=n(h),u=ct[i];return l&&v(u,d[u])(l),{body:d,baked:h,[t]:l,[i]:c&&n(c)}}}const Z=t=>t===null||typeof t!="object";function wt(t){return typeof t=="object"&&t!==null}function gt(t){return wt(t)&&!Array.isArray(t)}function N(t,e){return t===void 0?e:(e.value<t.value?t.left=N(t.left,e):t.right=N(t.right,e),t)}function V(t,e){t!==void 0&&(V(t.left,e),e(t),V(t.right,e))}function mt(){let t=0;const e={};return o=>{const n=Object.entries(o);let i;for(const[s,c]of n){const h=e[s]??={key:s,val:c,value:t++};h.val=c,h.left=void 0,h.right=void 0,i=N(i,h)}const r=[],l=[];return V(i,s=>{r.push(s.key),l.push(s.val)}),[r,l]}}function pt(t){return(e,o)=>(e-o)/o<=t}function xt({cornerCellValue:t,joinPrimitiveArrayValues:e,combineArraysOfObjects:o,proportionalSizeAdjustmentThreshold:n=1,collapseIndexes:i,stabilizeOrderOfPropertiesInArraysOfObjects:r=!0}){const l=pt(n),s=F({deduplicationComponent:"head",isProportionalResize:l,cornerCellValue:t}),c=F({deduplicationComponent:"indexes",isProportionalResize:l,cornerCellValue:t});function h(a,g){const{baked:f,indexes:m}=a,x=m!==null;if(x&&i){let S=0,A=f[0].height;const{rows:C,indexes:J}=m.data;for(let O=0;O<C.length;O++){const $=C[O];J[O]>=A&&(A+=f[++S].height);const U=g[S];$.cells[0].value=`${U}.${$.cells[0].value}`}return}const y=L(f.length,()=>({cells:[],columns:[]})),P=new Array(0);let T=0;for(let S=0;S<f.length;S++){const A=y[S],{height:C}=f[S];A.cells.push({height:C,width:1,value:g[S],type:E.Index}),A.columns.push(0),P.push(T),T+=C}const z={height:T,width:1,data:{rows:y,indexes:P}};a.indexes=x?W([z,m],T):z}function d(a,g){const{baked:f,head:m}=a,x=m!==null,I={cells:[],columns:[]};let y=0;for(let P=0;P<f.length;P++){const{width:T}=f[P];I.cells.push({height:1,width:T,value:g[P],type:E.Header}),I.columns.push(y),y+=T}x&&(m.data.rows.unshift(I),j(m.data.indexes,1),m.data.indexes.unshift(0)),a.head={width:y,height:x?m.height+1:1,data:x?m.data:{rows:[I],indexes:[0]}}}function u(a,g){const f=s(g);return h(f,a),delete f.baked,f}function w(a,g){const f=c(g);return d(f,a),delete f.baked,f}function p(a){const g=Object.keys(a);return g.length===0?_(""):w(g,g.map(f=>R(a[f])))}function k(a,g){const f=new Array(a.length),m=new Array(a.length);for(let x=0;x<a.length;x++)f[x]=String(x+1),m[x]=g(a[x]);return u(f,m)}function R(a){if(Z(a))return _(a);if(Array.isArray(a)){if(a.length===0)return _("");let g=!0,f=!0,m=0;for(;m<a.length&&(g||f);)g=g&&Z(a[m]),f=f&&gt(a[m]),m++;if(g)return _(a.join(", "));if(o&&f)return p(Object.assign({},...a));if(r&&f){const x=mt();return k(a,I=>{const[y,P]=x(I);return y.length===0?_(""):w(y,P.map(R))})}return k(a,R)}return p(a)}return R}function kt(t){const e=xt(t),o=D({cornerCellValue:t.cornerCellValue,head:!0,indexes:!0});return n=>o(e(n))}function St(t={}){const e={};for(const[i,r]of Object.entries(t))e[i]=r.with(1,{...r[1],"ui:options":{...r[1]["ui:options"],title:i}});const o=G(e),n=o.uiSchema;for(const i of Object.keys(n))n[i]={...n[i],"ui:options":{...n[i]?.["ui:options"],layouts:{"object-properties":{style:"display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;"}}}};return o}kt({cornerCellValue:"â„–",joinPrimitiveArrayValues:!0});export{St as c};
