import"./each.BSZzvnKu.js";import{p as C,f as G,e as D,t as B,b as H,a as Y,s as U,j as K,c as Q,r as W}from"./render.ZeYcUU_y.js";import{ad as b,g as X,e as Z,O as A,k as j}from"./definitions.DpSYVT72.js";import{c as S}from"./en.vWC8vtTR.js";import{B as ee}from"./basic-form.z_E4fsjh.js";import{d as re}from"./defaults.DDotbE7J.js";import{i as te,u as ie}from"./index.BPQVTpeN.js";import"./_commonjsHelpers.DaWZu8wl.js";import"./snippet.CUh4FENm.js";import"./file.DoTmUIgX.js";import"./form.mnusV9uI.js";import"./content.B0Df9X_2.js";import"./submit-button.DAFgVcFB.js";import"./assert.x788e5zp.js";import"./file-include.DjlWgwsA.js";import"./checkboxes-include.CVnblZkz.js";function V(e){return`${e}::ag`}let w;function v(e){return{lang:e?.lang??w?.lang,message:e?.message,abortEarly:e?.abortEarly??w?.abortEarly,abortPipeEarly:e?.abortPipeEarly??w?.abortPipeEarly}}let se;function ne(e){return se?.get(e)}let ue;function pe(e){return ue?.get(e)}let ae;function fe(e,r){return ae?.get(e)?.get(r)}function N(e){const r=typeof e;return r==="string"?`"${e}"`:r==="number"||r==="bigint"||r==="boolean"?`${e}`:r==="object"||r==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":r}function o(e,r,t,i,n){const u=n&&"input"in n?n.input:t.value,s=n?.expected??e.expects??null,p=n?.received??N(u),f={kind:e.kind,type:e.type,input:u,expected:s,received:p,message:`Invalid ${r}: ${s?`Expected ${s} but r`:"R"}eceived ${p}`,requirement:e.requirement,path:n?.path,issues:n?.issues,lang:i.lang,abortEarly:i.abortEarly,abortPipeEarly:i.abortPipeEarly},l=e.kind==="schema",a=n?.message??e.message??fe(e.reference,f.lang)??(l?pe(f.lang):null)??i.message??ne(f.lang);a!==void 0&&(f.message=typeof a=="function"?a(f):a),l&&(t.typed=!1),t.issues?t.issues.push(f):t.issues=[f]}function c(e){return{version:1,vendor:"valibot",validate(r){return e["~run"]({value:r},v())}}}function le(e,r){const t=[...new Set(e)];return t.length>1?`(${t.join(` ${r} `)})`:t[0]??"never"}function F(e,r){return{kind:"validation",type:"check",reference:F,async:!1,expects:null,requirement:e,message:r,"~run"(t,i){return t.typed&&!this.requirement(t.value)&&o(this,"input",t,i),t}}}function R(e,r){return{kind:"validation",type:"max_length",reference:R,async:!1,expects:`<=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length>this.requirement&&o(this,"length",t,i,{received:`${t.value.length}`}),t}}}function m(e,r){return{kind:"validation",type:"min_length",reference:m,async:!1,expects:`>=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length<this.requirement&&o(this,"length",t,i,{received:`${t.value.length}`}),t}}}function T(e,r){return{kind:"validation",type:"regex",reference:T,async:!1,expects:`${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&!this.requirement.test(t.value)&&o(this,"format",t,i),t}}}function ye(e,r,t){return typeof e.fallback=="function"?e.fallback(r,t):e.fallback}function _(e,r,t){return typeof e.default=="function"?e.default(r,t):e.default}function $(e,r){return{kind:"schema",type:"array",reference:$,expects:"Array",async:!1,item:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const n=t.value;if(Array.isArray(n)){t.typed=!0,t.value=[];for(let u=0;u<n.length;u++){const s=n[u],p=this.item["~run"]({value:s},i);if(p.issues){const f={type:"array",origin:"value",input:n,key:u,value:s};for(const l of p.issues)l.path?l.path.unshift(f):l.path=[f],t.issues?.push(l);if(t.issues||(t.issues=p.issues),i.abortEarly){t.typed=!1;break}}p.typed||(t.typed=!1),t.value.push(p.value)}}else o(this,"type",t,i);return t}}}function h(e){return{kind:"schema",type:"boolean",reference:h,expects:"boolean",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="boolean"?r.typed=!0:o(this,"type",r,t),r}}}function J(e,r){return{kind:"schema",type:"object",reference:J,expects:"Object",async:!1,entries:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const n=t.value;if(n&&typeof n=="object"){t.typed=!0,t.value={};for(const u in this.entries){const s=this.entries[u];if(u in n||(s.type==="exact_optional"||s.type==="optional"||s.type==="nullish")&&s.default!==void 0){const p=u in n?n[u]:_(s),f=s["~run"]({value:p},i);if(f.issues){const l={type:"object",origin:"value",input:n,key:u,value:p};for(const a of f.issues)a.path?a.path.unshift(l):a.path=[l],t.issues?.push(a);if(t.issues||(t.issues=f.issues),i.abortEarly){t.typed=!1;break}}f.typed||(t.typed=!1),t.value[u]=f.value}else if(s.fallback!==void 0)t.value[u]=ye(s);else if(s.type!=="exact_optional"&&s.type!=="optional"&&s.type!=="nullish"&&(o(this,"key",t,i,{input:void 0,expected:`"${u}"`,path:[{type:"object",origin:"key",input:n,key:u,value:n[u]}]}),i.abortEarly))break}}else o(this,"type",t,i);return t}}}function g(e,r){return{kind:"schema",type:"optional",reference:g,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:r,get"~standard"(){return c(this)},"~run"(t,i){return t.value===void 0&&(this.default!==void 0&&(t.value=_(this,t,i)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,i)}}}function L(e,r){return{kind:"schema",type:"picklist",reference:L,expects:le(e.map(N),"|"),async:!1,options:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){return this.options.includes(t.value)?t.typed=!0:o(this,"type",t,i),t}}}function O(e){return{kind:"schema",type:"string",reference:O,expects:"string",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="string"?r.typed=!0:o(this,"type",r,t),r}}}function de(e,r){const t={};for(const i in e.entries)t[i]=g(e.entries[i]);return{...e,entries:t,get"~standard"(){return c(this)}}}function k(...e){return{...e[0],pipe:e,get"~standard"(){return c(this)},"~run"(r,t){for(const i of e)if(i.kind!=="metadata"){if(r.issues&&(i.kind==="schema"||i.kind==="transformation")){r.typed=!1;break}(!r.issues||!t.abortEarly&&!t.abortPipeEarly)&&(r=i["~run"](r,t))}return r}}}function E(e,r,t){const i=e["~run"]({value:r},v(t));return{typed:i.typed,success:!i.issues,output:i.value,issues:i.issues}}function oe(e){switch(e.type){case"object":case"object_with_rest":case"loose_object":case"strict_object":return k(de(e),F(r=>Object.keys(e.entries).some(t=>r[t]!==void 0),"At least one field must be defined"))}}function ce({map:e=new Map}={}){return{get(r){return e.get(r)},register({errors:r,jsonSchema:t,valibotSchema:i}){if(r!==void 0)return;const n=e.size.toString();e.set(n,i);let u={...t};const s=i;switch(s.type){case"nullable":case"nullish":{const{anyOf:p}=t;if(p===void 0||p.length!==2||!b(p[1])||p[1].type!=="null")throw new Error(`'{ anyOf: [<inner schema>, { type: "null" }] }' schema is expected for ${s.type} Valibot schema, but got '${JSON.stringify(t)}'`);const f=p[0];if(f===void 0||!b(f)||f.type===void 0||Array.isArray(f.type))throw new Error("Your Valibot schema is currently unsupported, please consider opening an issue with your example");u={...f,type:[f.type,"null"]};break}case"union":case"variant":{const{anyOf:p,oneOf:f}=t,l=p??f;if(l===void 0||!l.every(b)||s.options.length!==l.length)throw new Error(`Expected 'anyOf' or 'oneOf' keyword for Valibot "${s.type}" type, but got '${Object.keys(t).join(", ")}'`);for(let a=0;a<l.length;a++){const q=s.options[a];if("pipe"in q)throw new Error("unions with pipes currently unsupported");const M=oe(q);if(M===void 0)continue;const{$id:P}=l[a];if(P===void 0)throw new Error("Id for item of 'anyOf' item not found");e.set(V(P),M)}break}}return u.$id=n,u}}}function ge(e,r){return e.success?{value:e.output}:{value:r,errors:e.issues.map(t=>({path:t.path?.map(n=>n.key)??[],message:t.message}))}}function ke(e){return e.path===void 0}function me(e){return e.success?[]:e.issues.filter(ke).map(r=>r.message)}function I(e,{$id:r,allOf:t}){if(r===void 0){const n=t?.[0];if(typeof n=="object"&&n.$id!==void 0)r=V(n.$id);else throw new Error("Schema id not found")}const i=e.get(r);if(i===void 0)throw new Error(`Valibot schema with id "${r}" not found`);return i}function _e({schemaRegistry:e}){return{isValid(r,t,i){if(typeof r=="boolean")return r;const n=I(e,r);return E(n,i).success}}}function be(e){return{validateFormValue(r,t){const i=I(e.schemaRegistry,r);return ge(E(i,t),t)}}}function we({schemaRegistry:e}){return{validateFieldValue(r,t){const i=I(e,r.schema);return me(E(i,t))}}}function $e(e){return Object.assign(_e(e),be(e),we(e))}function d(e,r){return e?(e.push(r),e):[r]}function x(e,r){switch(r?.errorMode){case"ignore":break;case"warn":console.warn(e);break;default:throw new Error(e)}}function Oe(e,r,t){if(t?.ignoreActions?.includes(r.type))return e;let i;switch(r.type){case"base64":e.contentEncoding="base64";break;case"bic":case"cuid2":case"decimal":case"digits":case"emoji":case"hexadecimal":case"hex_color":case"nanoid":case"octal":case"ulid":e.pattern=r.requirement.source;break;case"description":e.description=r.description;break;case"email":e.format="email";break;case"empty":e.type==="array"?e.maxItems=0:(e.type!=="string"&&(i=d(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=0);break;case"entries":e.minProperties=r.requirement,e.maxProperties=r.requirement;break;case"examples":Array.isArray(e.examples)?e.examples=[...e.examples,...r.examples]:e.examples=r.examples;break;case"integer":e.type="integer";break;case"ipv4":e.format="ipv4";break;case"ipv6":e.format="ipv6";break;case"iso_date":e.format="date";break;case"iso_date_time":case"iso_timestamp":e.format="date-time";break;case"iso_time":e.format="time";break;case"length":e.type==="array"?(e.minItems=r.requirement,e.maxItems=r.requirement):(e.type!=="string"&&(i=d(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement,e.maxLength=r.requirement);break;case"max_entries":e.maxProperties=r.requirement;break;case"max_length":e.type==="array"?e.maxItems=r.requirement:(e.type!=="string"&&(i=d(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=r.requirement);break;case"max_value":e.type!=="number"&&e.type!=="integer"&&(i=d(i,`The "max_value" action is not supported on type "${e.type}".`)),e.maximum=r.requirement;break;case"metadata":typeof r.metadata.title=="string"&&(e.title=r.metadata.title),typeof r.metadata.description=="string"&&(e.description=r.metadata.description),Array.isArray(r.metadata.examples)&&(Array.isArray(e.examples)?e.examples=[...e.examples,...r.metadata.examples]:e.examples=r.metadata.examples);break;case"min_entries":e.minProperties=r.requirement;break;case"min_length":e.type==="array"?e.minItems=r.requirement:(e.type!=="string"&&(i=d(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement);break;case"min_value":e.type!=="number"&&e.type!=="integer"&&(i=d(i,`The "min_value" action is not supported on type "${e.type}".`)),e.minimum=r.requirement;break;case"multiple_of":e.multipleOf=r.requirement;break;case"non_empty":e.type==="array"?e.minItems=1:(e.type!=="string"&&(i=d(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=1);break;case"regex":r.requirement.flags&&(i=d(i,"RegExp flags are not supported by JSON Schema.")),e.pattern=r.requirement.source;break;case"title":e.title=r.title;break;case"url":e.format="uri";break;case"uuid":e.format="uuid";break;case"value":e.const=r.requirement;break;default:i=d(i,`The "${r.type}" action cannot be converted to JSON Schema.`)}if(t?.overrideAction){const n=t.overrideAction({valibotAction:r,jsonSchema:e,errors:i});if(n)return{...n}}if(i)for(const n of i)x(n,t);return e}function z(e){return e.flatMap(r=>"pipe"in r?z(r.pipe):r)}let xe=0;function y(e,r,t,i,n=!1){if(!n){const s=i.referenceMap.get(r);if(s){if(e.$ref=`#/$defs/${s}`,t?.overrideRef){const p=t.overrideRef({...i,referenceId:s,valibotSchema:r,jsonSchema:e});p&&(e.$ref=p)}return e}}if("pipe"in r){const s=z(r.pipe);let p=0,f=s.length-1;if(t?.typeMode==="input"){const l=s.slice(1).findIndex(a=>a.kind==="schema"||a.kind==="transformation"&&(a.type==="find_item"||a.type==="parse_json"||a.type==="raw_transform"||a.type==="reduce_items"||a.type==="stringify_json"||a.type==="to_bigint"||a.type==="to_boolean"||a.type==="to_date"||a.type==="to_number"||a.type==="to_string"||a.type==="transform"));l!==-1&&(f=l)}else if(t?.typeMode==="output"){const l=s.findLastIndex(a=>a.kind==="schema");l!==-1&&(p=l)}for(let l=p;l<=f;l++){const a=s[l];a.kind==="schema"?(l>p&&x('Set the "typeMode" config to "input" or "output" to convert pipelines with multiple schemas.',t),e=y(e,a,t,i,!0)):e=Oe(e,a,t)}return e}let u;switch(r.type){case"boolean":e.type="boolean";break;case"null":t?.target==="openapi-3.0"?e.enum=[null]:e.type="null";break;case"number":e.type="number";break;case"string":e.type="string";break;case"array":e.type="array",e.items=y({},r.item,t,i);break;case"tuple":case"tuple_with_rest":case"loose_tuple":case"strict_tuple":if(e.type="array",t?.target==="openapi-3.0"){e.items={anyOf:[]},e.minItems=r.items.length;for(const s of r.items)e.items.anyOf.push(y({},s,t,i));r.type==="tuple_with_rest"?e.items.anyOf.push(y({},r.rest,t,i)):(r.type==="strict_tuple"||r.type==="tuple")&&(e.maxItems=r.items.length)}else if(t?.target==="draft-2020-12"){e.prefixItems=[],e.minItems=r.items.length;for(const s of r.items)e.prefixItems.push(y({},s,t,i));r.type==="tuple_with_rest"?e.items=y({},r.rest,t,i):r.type==="strict_tuple"&&(e.items=!1)}else{e.items=[],e.minItems=r.items.length;for(const s of r.items)e.items.push(y({},s,t,i));r.type==="tuple_with_rest"?e.additionalItems=y({},r.rest,t,i):r.type==="strict_tuple"&&(e.additionalItems=!1)}break;case"object":case"object_with_rest":case"loose_object":case"strict_object":e.type="object",e.properties={},e.required=[];for(const s in r.entries){const p=r.entries[s];e.properties[s]=y({},p,t,i),p.type!=="exact_optional"&&p.type!=="nullish"&&p.type!=="optional"&&e.required.push(s)}r.type==="object_with_rest"?e.additionalProperties=y({},r.rest,t,i):r.type==="strict_object"&&(e.additionalProperties=!1);break;case"record":t?.target==="openapi-3.0"&&"pipe"in r.key&&(u=d(u,'The "record" schema with a schema for the key that contains a "pipe" cannot be converted to JSON Schema.')),r.key.type!=="string"&&(u=d(u,`The "record" schema with the "${r.key.type}" schema for the key cannot be converted to JSON Schema.`)),e.type="object",t?.target!=="openapi-3.0"&&(e.propertyNames=y({},r.key,t,i)),e.additionalProperties=y({},r.value,t,i);break;case"any":case"unknown":break;case"nullable":case"nullish":if(t?.target==="openapi-3.0"){const s=y({},r.wrapped,t,i);Object.assign(e,s),e.nullable=!0}else e.anyOf=[y({},r.wrapped,t,i),{type:"null"}];r.default!==void 0&&(e.default=_(r));break;case"exact_optional":case"optional":case"undefinedable":e=y(e,r.wrapped,t,i),r.default!==void 0&&(e.default=_(r));break;case"literal":typeof r.literal!="boolean"&&typeof r.literal!="number"&&typeof r.literal!="string"&&(u=d(u,'The value of the "literal" schema is not JSON compatible.')),t?.target==="openapi-3.0"?e.enum=[r.literal]:e.const=r.literal;break;case"enum":e.enum=r.options;break;case"picklist":r.options.some(s=>typeof s!="number"&&typeof s!="string")&&(u=d(u,'An option of the "picklist" schema is not JSON compatible.')),e.enum=r.options;break;case"union":e.anyOf=r.options.map(s=>y({},s,t,i));break;case"variant":e.oneOf=r.options.map(s=>y({},s,t,i));break;case"intersect":e.allOf=r.options.map(s=>y({},s,t,i));break;case"lazy":{let s=i.getterMap.get(r.getter);s||(s=r.getter(void 0),i.getterMap.set(r.getter,s));let p=i.referenceMap.get(s);if(p||(p=`${xe++}`,i.referenceMap.set(s,p),i.definitions[p]=y({},s,t,i,!0)),e.$ref=`#/$defs/${p}`,t?.overrideRef){const f=t.overrideRef({...i,referenceId:p,valibotSchema:s,jsonSchema:e});f&&(e.$ref=f)}break}default:u=d(u,`The "${r.type}" schema cannot be converted to JSON Schema.`)}if(t?.overrideSchema){const s=t.overrideSchema({...i,referenceId:i.referenceMap.get(r),valibotSchema:r,jsonSchema:e,errors:u});if(s)return{...s}}if(u)for(const s of u)x(s,t);return e}let Ee;function Ie(){return Ee}function qe(e,r){const t={definitions:{},referenceMap:new Map,getterMap:new Map},i=r?.definitions??Ie();if(i){for(const s in i)t.referenceMap.set(i[s],s);for(const s in i)t.definitions[s]=y({},i[s],r,t,!0)}const n=y({},e,r,t),u=r?.target??"draft-07";return u==="draft-2020-12"?n.$schema="https://json-schema.org/draft/2020-12/schema":u==="draft-07"&&(n.$schema="http://json-schema.org/draft-07/schema#"),t.referenceMap.size&&(n.$defs=t.definitions),n}function Me({createFormValidator:e}){return r=>{const t=ce(),i=qe(r,{overrideSchema:t.register,typeMode:"input"});return{schemaRegistry:t,schema:i,validator:e(t)}}}function Pe(e){return(r={})=>$e(Object.setPrototypeOf({schemaRegistry:e},r))}const Ve=Me({createFormValidator:Pe}),ve=Ve;var Ne=G("<!> <pre> </pre>",1);function We(e,r){C(r,!0);const t=J({id:g(k(O(),T(new RegExp("^\\d+$"),"Must be a number"),m(8))),active:g(h()),skills:g(k($(k(O(),m(5))),m(4))),multipleChoicesList:g(k($(L(["foo","bar","fuzz"])),R(2)))}),i=S({...re,...ve(t),uiSchema:ie,fieldsValidationMode:Z|A|j,initialValue:te});var n=Ne(),u=D(n);ee(u,{get form(){return i},novalidate:!0});var s=U(u,2),p=Q(s,!0);W(s),B(f=>K(p,f),[()=>JSON.stringify(X(i),null,2)]),H(e,n),Y()}export{We as default};
