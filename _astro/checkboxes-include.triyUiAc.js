import{b as z,c as ie}from"./assert.CVu_g0UR.js";import{ad as h,am as oe,an as se,ao as ce,ap as N,aq as ue,ar as le,as as fe,at as U,R as de,au as me,av as pe,aw as ge,ax as be,ae as ye,af as W,ag as ve,ah as _e,U as Ae,ay as Fe,p as S,n as C,$ as he,q as B,a0 as Se,a7 as Oe,a8 as Ee,z as H,a3 as Re,a4 as Te,s as we,r as xe,a5 as ke}from"./definitions.C59jdWoE.js";import{e as Ve}from"./each.BMERpw53.js";import{p as O,m as x,f as k,b as A,a as E,g,u as _,n as Ce,a_ as Me,c as L,e as Pe,s as De,r as Le,t as je,j as Ie}from"./render.C83cpEEf.js";import{s as Ne}from"./snippet.BHClqOtQ.js";import{c as Ue,g as We,b as j}from"./file.BOOVhI6r.js";import{b as Be,u as He,j as I,w as ze,i as Y,f as Ye,m as qe,g as Ge}from"./en.tQk8GjFB.js";function V(e,t,n={type:"root",path:[]}){if(!h(e))return t(e,n);const r={...e};for(const i of oe){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:n.path.concat(i,0)};r[i]=c.map((f,u)=>(o.index=u,o.path[o.path.length-1]=u,V(f,t,o)))}const a=new Map;for(const i of se){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:n.path.concat(i,"")},f=Object.keys(c),u=f.length;for(let d=0;d<u;d++){const m=f[d],b=c[m];if(Array.isArray(b)){a.set(m,b);continue}o.property=m,o.path[o.path.length-1]=m,a.set(m,V(b,t,o))}r[i]=Object.fromEntries(a),a.clear()}const s={type:"sub",parent:e,key:"items",path:n.path.concat("")};for(const i of ce){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,r[i]=V(c,t,s))}return t(r,n)}function Ke(e,t){return V(e,n=>{if(!h(n))return n;const r=n[N];return r!==void 0&&r.startsWith("#")&&(n[N]=`${t}${r}`),n})}function q(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function Ot(e){if(e==="#")return[];const t=q(e);let n=!1;return t.map(r=>{if(n){const a=Number(r);if(Number.isInteger(a)&&a>=0)return n=!1,a}return n=ue.has(r),r})}function Xe(e,t){const n=[];if(e==="")return n;const r=q(e);let a=t;for(const s of r)if(Array.isArray(a)&&/^\d+$/.test(s)){const i=Number(s);n.push(i),a=a[i]}else n.push(s),a=a?.[s];return n}function Et(e,t,n,r,a,s){function i(o,f,u,d){const m=o.map(p=>typeof p=="boolean"?p?{}:{not:{}}:p),b=me(e,t,n,d,m,-1,pe(f)),y=c(m[b],u,d);if(y!==void 0)return y;let l;for(const p of m){if(!h(p))continue;const v=c(p,u,d);if(v!==void 0){if(h(v))return v;l=v}}return l}function c(o,f,u){for(let d=0;d<f.length;d++){if(o===void 0||!h(o))return;if(o.$ref)return c(le(o.$ref,n),f.slice(d),u);if(o.allOf){const l=t.mergeAllOf(o);if(!l.allOf)return c(l,f.slice(d),u)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const l=i(m,o,f.slice(d),u);if(l!==void 0)return l}const b=f[d],y=typeof b;if(y==="number"){const{items:l,additionalItems:p}=o;o=(Array.isArray(l)?l[b]:l)??p,u=fe(u)?u[b]:void 0;continue}if(y==="string"){const{properties:l,patternProperties:p,additionalProperties:v,dependencies:M,then:F,else:R}=o;o=(l&&l[b])??(p&&Object.entries(p).find(([P])=>new RegExp(P).test(b))?.[1])??v??(M&&i(Object.values(M).filter(U),o,f.slice(d),u))??((F||R)&&i([F,R].filter(U),o,f.slice(d),u)),u=de(u)?u[b]:void 0;continue}return}return o}return c(r,a,s)}const Je={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},Qe=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,Ze=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function $e(e){return e.addFormat("color",Qe),e.addFormat(be,Ze),e}function et(e){return e.addKeyword(ge),e}function tt(e){return et($e(e))}function D(e,t,n=new WeakMap){let r="",a=!1;const s=ve(n,i=>{let c=i;return a&&(c=Ke(i,r),delete c[W]),e.compile(c)});return(i,c)=>{r=c[W]??ye;let o=e.getSchema(r)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(r),n.delete(i),o=void 0),o===void 0&&e.addSchema(c,r),a=i!==c,s(i)}}function G(e,t){const r=_e(new WeakMap,a=>e.compile({...a,$async:t}));return a=>r(a.schema)}function nt({params:{missingProperty:e,propertyName:t},propertyName:n=t},r){let a=r;return a=e!==void 0?r.concat(e):a,a=n!==void 0?r.concat(n,Ae("key-input")):a,a}function K({params:{missingProperty:e},parentSchema:t,message:n},r){if(!n)return"";if(e===void 0)return n;const a=r(e,t);return a===void 0?n:n.replace(e,a)}function X({uiSchema:e={}}){return(t,n)=>({value:n,errors:t.map(r=>{const a=Xe(r.instancePath,n);return{path:nt(r,a),message:K(r,(s,i)=>{const c=Fe(e,a.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function J(e){return e.instancePath===""}function rt(e){return J(e)&&e.keyword!=="type"}function Q(e){return t=>t.filter(e.required?J:rt).map(n=>K(n,()=>e.title))}function Z(e,t,n,r){e(t);const a=e.errors;return e.errors=null,a?r(a,t):n(t)}async function $(e,t,n,r){try{await e(t)}catch(a){if(!(a instanceof z.Ajv.ValidationError))throw a;return r(a.errors,t)}finally{e.errors=null}return n(t)}const ee=e=>({value:e}),te=()=>[];function ne({compileSchema:e}){return{isValid(t,n,r){if(typeof t=="boolean")return t;const a=e(t,n);try{return a(r)}catch(s){return console.warn("Failed to validate",s),!1}}}}function at(e){const t=X(e);return{validateFormValue(n,r){return Z(e.compileSchema(n,n),r,ee,t)}}}function it({compileFieldSchema:e}){return{validateFieldValue(t,n){return Z(e(t),n,te,Q(t))}}}function ot(e){const t=X(e);return{async validateFormValueAsync(n,r,a){return $(e.compileAsyncSchema(r,r),a,ee,t)}}}function st({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,n,r){return $(e(n),r,te,Q(n))}}}function Rt({ajvOptions:e=Je,ajvPlugins:t=tt,ajv:n=t(new z.Ajv(e)),validatorsCache:r,compileSchema:a=D(n,!1,r),compileFieldSchema:s=G(n,!1),...i}={}){const c={...i,compileSchema:a,compileFieldSchema:s};return Object.assign(ne(c),at(c),it(c))}function Tt({ajv:e,validatorsCache:t,compileSchema:n=D(e,!1,t),compileAsyncSchema:r=D(e,!0,t),compileAsyncFieldSchema:a=G(e,!0),...s}){const i={...s,compileSchema:n,compileAsyncSchema:r,compileAsyncFieldSchema:a};return Object.assign(ne(i),ot(i),st(i))}const ct="nativeFileField";function ut(e,t){O(t,!0);const n=y=>{var l=x(),p=k(l);Ne(p,()=>g(d)??Ce,()=>a,()=>t.config,()=>({get current(){return r()},set current(v){r(v)}}),()=>g(f)),A(y,l)};let r=S(t,"value",15);const a=C(),s=_(()=>H(a,"fieldTemplate",t.config)),i="fileWidget",c=_(()=>H(a,i,t.config)),o=he(a,()=>t.config,()=>Se(a,t.config,r())),f=_(()=>Re(a,t.config.path)),u=Ue({combinator:We,async execute(y,l){if(l===void 0||l.length===0)return;const p=l[0];if(!await Oe(y,a,t.config,l))throw new Ee;return p},onSuccess(y){r(y)}}),d=_(()=>Te(a,t.config,ct));var m=x(),b=k(m);{let y=_(()=>g(d)&&n);B(b,()=>g(s),(l,p)=>{p(l,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return r()},get config(){return t.config},get errors(){return g(f)},get action(){return g(y)},children:(v,M)=>{var F=x(),R=k(F),P=()=>{const T=r(),w=new DataTransfer;return T&&w.items.add(T),w.files},re=u.run;B(R,()=>g(c),(T,w)=>{w(T,{type:"widget",get value(){return P()},set value(ae){re(ae)},get processing(){return u.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return g(f)},get config(){return t.config},multiple:!1})}),A(v,F)},$$slots:{default:!0}})})}A(e,m),E()}function lt(e,t){O(t,!0);let n=S(t,"value",15),r=xe(t,["$$slots","$$events","$$legacy","value"]);var a=()=>(ie(n()),n()),s=i=>{n(i)};ut(e,we({get value(){return a()},set value(i){s(i)}},()=>r)),E()}ke.unknownNativeFileField=lt;var ft=L("<textarea></textarea>");function dt(e,t){O(t,!0);let n=S(t,"value",15);const r=C(),a=_(()=>He(r,t.config,"textarea",t.handlers,{class:"sjsf-textarea"}));var s=ft();Me(s),j(s,()=>({...g(a)})),Be(s,n),A(e,s),E()}I.textareaWidget=dt;var mt=L("<input/>");function pt(e,t){O(t,!0);let n=S(t,"value",15);const r=C(),a=_(()=>Y(r,t.config,"file",t.handlers,{multiple:t.multiple,class:"sjsf-file","data-loading":t.loading,"data-processing":t.processing}));var s=mt();j(s,()=>({type:"file",...g(a)}),void 0,void 0,void 0,void 0,!0),ze(s,n),A(e,s),E()}I.fileWidget=pt;var gt=L('<label class="sjsf-checkboxes"><input/> </label>');function bt(e,t){O(t,!0);const n=[];let r=S(t,"value",15);const a=C(),s=_(()=>Y(a,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=qe({mapper:()=>Ge(t.options),value:()=>r(),update:f=>r(f)});var c=x(),o=k(c);Ve(o,17,()=>t.options,f=>f.id,(f,u)=>{var d=gt(),m=Pe(d);j(m,()=>({value:g(u).id,...g(s),id:g(u).id,disabled:g(u).disabled||g(s).disabled}),void 0,void 0,void 0,void 0,!0);var b=De(m);Le(d),je(()=>Ie(b,` ${g(u).label??""}`)),Ye(n,[],m,()=>(g(u).id,i.current),y=>i.current=y),A(f,d)}),A(e,c),E()}I.checkboxesWidget=bt;export{ee as C,te as N,tt as a,Tt as b,Rt as c,Ot as d,X as e,Q as f,Et as g,Ke as h,Xe as p,Z as v};
