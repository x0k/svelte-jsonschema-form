import{a6 as E,p as I,n as R,$ as C,q as y,a0 as U,a7 as W,a8 as k,z as O,a3 as q,a4 as z,a5 as H}from"./definitions.CSxasTmI.js";import"./each.BUIN7b2g.js";import{p as M,m,d as p,b as v,a as V,g as o,u as l,n as j}from"./render.B1sJ9xBI.js";import{s as G}from"./snippet.ByESBxjV.js";import{d as J,f as K}from"./file.DQaQn80e.js";async function T(u,e,c,a){const{name:t,blob:s}=await u[E](e,a);c.items.add(new File([s],t,{type:s.type}))}function te(u,e,c,a){const t=[];for(const s of a)t.push(T(u,e,c,s));return Promise.all(t)}const N="fileField";function Q(u,e){M(e,!0);const c=i=>{var n=m(),r=p(n);G(r,()=>o(h)??j,()=>t,()=>e.config,()=>({get current(){return a()},set current(f){a(f)}}),()=>o(g)),v(i,n)};let a=I(e,"value",15);const t=R(),s=l(()=>O(t,"fieldTemplate",e.config)),F="fileWidget",L=l(()=>O(t,F,e.config)),A=C(t,()=>e.config,()=>U(t,e.config,a())),d=J({initialOutput:void 0,getInput:()=>a(),setInput:i=>a(i),async toOutput(i,n){const r=new DataTransfer;return n&&await T(t,i,r,n),r.files},async toInput(i,n){if(n===void 0||n.length===0)return;const r=n[0];if(!await W(i,t,e.config,n))throw new k;return K(i,r)}}),g=l(()=>q(t,e.config.path)),h=l(()=>z(t,e.config,N));var w=m(),b=p(w);{let i=l(()=>o(h)&&c);y(b,()=>o(s),(n,r)=>{r(n,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return e.uiOption},widgetType:F,get value(){return a()},get config(){return e.config},get errors(){return o(g)},get action(){return o(i)},children:(f,S)=>{var _=m(),P=p(_);y(P,()=>o(L),(x,B)=>{B(x,{type:"widget",get processing(){return d.inputProcessing},get loading(){return d.outputProcessing},get uiOption(){return e.uiOption},get handlers(){return A},get errors(){return o(g)},get config(){return e.config},multiple:!1,get value(){return d.current},set value(D){d.current=D}})}),v(f,_)},$$slots:{default:!0}})})}v(u,w),V()}H.fileField=Q;export{te as a};
