import{a5 as C,D as E,m as I,U as R,n as y,V as U,a6 as V,a7 as W,C as O,X as k,Z as H,_ as M}from"./definitions.NezjAKKV.js";import"./each.DtQj7XuE.js";import{p as X,m,a as p,b as v,c as Z,g as o,u as l,n as j}from"./render.DFb7sxVl.js";import{s as q}from"./snippet.BEIUVV7c.js";import{d as z,f as G}from"./file.CoIUK_ib.js";async function T(u,e,c,i){const{name:t,blob:s}=await u[C](e,i);c.items.add(new File([s],t,{type:s.type}))}function te(u,e,c,i){const t=[];for(const s of i)t.push(T(u,e,c,s));return Promise.all(t)}const J="fileField";function K(u,e){X(e,!0);const c=r=>{var n=m(),a=p(n);q(a,()=>o(_)??j,()=>t,()=>e.config,()=>({get current(){return i()},set current(f){i(f)}}),()=>o(g)),v(r,n)};let i=E(e,"value",15);const t=I(),s=l(()=>O(t,"fieldTemplate",e.config)),F="fileWidget",L=l(()=>O(t,F,e.config)),A=R(t,()=>e.config,()=>U(t,e.config,i())),d=z({initialOutput:void 0,getInput:()=>i(),setInput:r=>i(r),async toOutput(r,n){const a=new DataTransfer;return n&&await T(t,r,a,n),a.files},async toInput(r,n){if(n===void 0||n.length===0)return;const a=n[0];if(!await V(r,t,e.config,n))throw new W;return G(r,a)}}),g=l(()=>k(t,e.config.path)),_=l(()=>H(t,e.config,J));var h=m(),b=p(h);{let r=l(()=>o(_)&&c);y(b,()=>o(s),(n,a)=>{a(n,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return e.uiOption},widgetType:F,get value(){return i()},get config(){return e.config},get errors(){return o(g)},get action(){return o(r)},children:(f,N)=>{var w=m(),D=p(w);y(D,()=>o(L),(P,x)=>{x(P,{type:"widget",get processing(){return d.inputProcessing},get loading(){return d.outputProcessing},get uiOption(){return e.uiOption},get handlers(){return A},get errors(){return o(g)},get config(){return e.config},multiple:!1,get value(){return d.current},set value(B){d.current=B}})}),v(f,w)},$$slots:{default:!0}})})}v(u,h),Z()}M.fileField=K;export{te as a};
