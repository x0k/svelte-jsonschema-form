import{ad as F,al as oe,am as se,an as ce,ao as N,ap as ue,aq as le,ar as fe,as as U,P as de,at as me,au as pe,p as S,m as C,_ as ge,n as W,$ as be,a0 as ve,a1 as ye,x as B,a2 as _e,a3 as Ae,s as he,r as Fe,a4 as Se,av as Oe,aw as Ee,ae as Re,af as H,ag as Y,R as xe,ax as Te}from"./definitions.B0V5iSUw.js";import{e as we}from"./each.CnJSAi8U.js";import{p as O,m as w,e as k,b as A,a as E,g,u as _,n as ke,f as L,a_ as Ve,c as Ce,s as Me,r as Pe,t as De,h as Le}from"./render.BhfrqoSn.js";import{b as Ie,c as G}from"./ajv.BqMuc0xL.js";import{s as je}from"./snippet.CJeKierg.js";import{c as Ne,g as Ue,b as I}from"./file.DVTUT3V0.js";import{b as We,u as Be,j,x as He,i as K,f as Ye,m as Ge,g as Ke}from"./en.bcHP5YK1.js";function V(e,t,n={type:"root",path:[]}){if(!F(e))return t(e,n);const a={...e};for(const i of oe){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:n.path.concat(i,0)};a[i]=c.map((f,u)=>(o.index=u,o.path[o.path.length-1]=u,V(f,t,o)))}const r=new Map;for(const i of se){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:n.path.concat(i,"")},f=Object.keys(c),u=f.length;for(let d=0;d<u;d++){const m=f[d],b=c[m];if(Array.isArray(b)){r.set(m,b);continue}o.property=m,o.path[o.path.length-1]=m,r.set(m,V(b,t,o))}a[i]=Object.fromEntries(r),r.clear()}const s={type:"sub",parent:e,key:"items",path:n.path.concat("")};for(const i of ce){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,a[i]=V(c,t,s))}return t(a,n)}function qe(e,t){return V(e,n=>{if(!F(n))return n;const a=n[N];return a!==void 0&&a.startsWith("#")&&(n[N]=`${t}${a}`),n})}function q(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function St(e){if(e==="#")return[];const t=q(e);let n=!1;return t.map(a=>{if(n){const r=Number(a);if(Number.isInteger(r)&&r>=0)return n=!1,r}return n=ue.has(a),a})}function ze(e,t){const n=[];if(e==="")return n;const a=q(e);let r=t;for(const s of a)if(Array.isArray(r)&&/^\d+$/.test(s)){const i=Number(s);n.push(i),r=r[i]}else n.push(s),r=r?.[s];return n}function Ot(e,t,n,a,r,s){function i(o,f,u,d){const m=o.map(p=>typeof p=="boolean"?p?{}:{not:{}}:p),b=me(e,t,n,d,m,-1,pe(f)),v=c(m[b],u,d);if(v!==void 0)return v;let l;for(const p of m){if(!F(p))continue;const y=c(p,u,d);if(y!==void 0){if(F(y))return y;l=y}}return l}function c(o,f,u){for(let d=0;d<f.length;d++){if(o===void 0||!F(o))return;if(o.$ref)return c(le(o.$ref,n),f.slice(d),u);if(o.allOf){const l=t.mergeAllOf(o);if(!l.allOf)return c(l,f.slice(d),u)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const l=i(m,o,f.slice(d),u);if(l!==void 0)return l}const b=f[d],v=typeof b;if(v==="number"){const{items:l,additionalItems:p}=o;o=(Array.isArray(l)?l[b]:l)??p,u=fe(u)?u[b]:void 0;continue}if(v==="string"){const{properties:l,patternProperties:p,additionalProperties:y,dependencies:M,then:h,else:R}=o;o=(l&&l[b])??(p&&Object.entries(p).find(([P])=>new RegExp(P).test(b))?.[1])??y??(M&&i(Object.values(M).filter(U),o,f.slice(d),u))??((h||R)&&i([h,R].filter(U),o,f.slice(d),u)),u=de(u)?u[b]:void 0;continue}return}return o}return c(a,r,s)}const Xe="nativeFileField";function Je(e,t){O(t,!0);const n=v=>{var l=w(),p=k(l);je(p,()=>g(d)??ke,()=>r,()=>t.config,()=>({get current(){return a()},set current(y){a(y)}}),()=>g(f)),A(v,l)};let a=S(t,"value",15);const r=C(),s=_(()=>B(r,"fieldTemplate",t.config)),i="fileWidget",c=_(()=>B(r,i,t.config)),o=ge(r,()=>t.config,()=>be(r,t.config,a())),f=_(()=>_e(r,t.config.path)),u=Ne({combinator:Ue,async execute(v,l){if(l===void 0||l.length===0)return;const p=l[0];if(!await ve(v,r,t.config,l))throw new ye;return p},onSuccess(v){a(v)}}),d=_(()=>Ae(r,t.config,Xe));var m=w(),b=k(m);{let v=_(()=>g(d)&&n);W(b,()=>g(s),(l,p)=>{p(l,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return a()},get config(){return t.config},get errors(){return g(f)},get action(){return g(v)},children:(y,M)=>{var h=w(),R=k(h),P=()=>{const x=a(),T=new DataTransfer;return x&&T.items.add(x),T.files},ae=u.run;W(R,()=>g(c),(x,T)=>{T(x,{type:"widget",get value(){return P()},set value(ie){ae(ie)},get processing(){return u.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return g(f)},get config(){return t.config},multiple:!1})}),A(y,h)},$$slots:{default:!0}})})}A(e,m),E()}function Qe(e,t){O(t,!0);let n=S(t,"value",15),a=Fe(t,["$$slots","$$events","$$legacy","value"]);var r=()=>(Ie(n()),n()),s=i=>{n(i)};Je(e,he({get value(){return r()},set value(i){s(i)}},()=>a)),E()}Se.unknownNativeFileField=Qe;var Ze=L("<textarea></textarea>");function $e(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>Be(a,t.config,"textarea",t.handlers,{class:"sjsf-textarea"}));var s=Ze();Ve(s),I(s,()=>({...g(r)})),We(s,n),A(e,s),E()}j.textareaWidget=$e;var et=L("<input/>");function tt(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>K(a,t.config,"file",t.handlers,{multiple:t.multiple,class:"sjsf-file","data-loading":t.loading,"data-processing":t.processing}));var s=et();I(s,()=>({type:"file",...g(r)}),void 0,void 0,void 0,void 0,!0),He(s,n),A(e,s),E()}j.fileWidget=tt;var nt=L('<label class="sjsf-checkboxes"><input/> </label>');function rt(e,t){O(t,!0);const n=[];let a=S(t,"value",15);const r=C(),s=_(()=>K(r,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=Ge({mapper:()=>Ke(t.options),value:()=>a(),update:f=>a(f)});var c=w(),o=k(c);we(o,17,()=>t.options,f=>f.id,(f,u)=>{var d=nt(),m=Ce(d);I(m,()=>({value:g(u).id,...g(s),id:g(u).id,disabled:g(u).disabled||g(s).disabled}),void 0,void 0,void 0,void 0,!0);var b=Me(m);Pe(d),De(()=>Le(b,` ${g(u).label??""}`)),Ye(n,[],m,()=>(g(u).id,i.value),v=>i.value=v),A(f,d)}),A(e,c),E()}j.checkboxesWidget=rt;const at={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},it=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,ot=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function st(e){return e.addFormat("color",it),e.addFormat(Ee,ot),e}function ct(e){return e.addKeyword(Oe),e}function ut(e){return ct(st(e))}function D(e,t){let n="",a=!1;const r=new WeakMap,s=Y(r,i=>{let c=i;return a&&(c=qe(i,n),delete c[H]),e.compile(c)});return(i,c)=>{n=c[H]??Re;let o=e.getSchema(n)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(n),r.delete(i),o=void 0),o===void 0&&e.addSchema(c,n),a=i!==c,s(i)}}function z(e,t){const a=Y(new WeakMap,r=>e.compile({...r,$async:t}));return r=>a(r.schema)}function lt({params:{missingProperty:e,propertyName:t},propertyName:n=t},a){let r=a;return r=e!==void 0?a.concat(e):r,r=n!==void 0?a.concat(n,xe("key-input")):r,r}function X({params:{missingProperty:e},parentSchema:t,message:n},a){if(!n)return"";if(e===void 0)return n;const r=a(e,t);return r===void 0?n:n.replace(e,r)}function J({uiSchema:e={}}){return(t,n)=>({value:n,errors:t.map(a=>{const r=ze(a.instancePath,n);return{path:lt(a,r),message:X(a,(s,i)=>{const c=Te(e,r.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function Q(e){return e.instancePath===""}function ft(e){return Q(e)&&e.keyword!=="type"}function Z(e){return t=>t.filter(e.required?Q:ft).map(n=>X(n,()=>e.title))}function $(e,t,n,a){e(t);const r=e.errors;return e.errors=null,r?a(r,t):n(t)}async function ee(e,t,n,a){try{await e(t)}catch(r){if(!(r instanceof G.Ajv.ValidationError))throw r;return a(r.errors,t)}finally{e.errors=null}return n(t)}const te=e=>({value:e}),ne=()=>[];function re({compileSchema:e}){return{isValid(t,n,a){if(typeof t=="boolean")return t;const r=e(t,n);try{return r(a)}catch(s){return console.warn("Failed to validate",s),!1}}}}function dt(e){const t=J(e);return{validateFormValue(n,a){return $(e.compileSchema(n,n),a,te,t)}}}function mt({compileFieldSchema:e}){return{validateFieldValue(t,n){return $(e(t),n,ne,Z(t))}}}function pt(e){const t=J(e);return{async validateFormValueAsync(n,a,r){return ee(e.compileAsyncSchema(a,a),r,te,t)}}}function gt({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,n,a){return ee(e(n),a,ne,Z(n))}}}function Et({ajvOptions:e=at,ajvPlugins:t=ut,ajv:n=t(new G.Ajv(e)),compileSchema:a=D(n),compileFieldSchema:r=z(n,!1),...s}={}){const i={...s,compileSchema:a,compileFieldSchema:r};return Object.assign(re(i),dt(i),mt(i))}function Rt({ajv:e,compileSchema:t=D(e),compileAsyncSchema:n=D(e),compileAsyncFieldSchema:a=z(e,!0),...r}){const s={...r,compileSchema:t,compileAsyncSchema:n,compileAsyncFieldSchema:a};return Object.assign(re(s),pt(s),gt(s))}export{te as C,ne as N,ut as a,Rt as b,Et as c,St as d,J as e,Z as f,Ot as g,qe as h,ze as p,$ as v};
