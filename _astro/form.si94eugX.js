import"./_commonjsHelpers.BQuq4T_S.js";import{p as h,f as L,a as J,t as R,b as N,c as V,s as F,i as z,e as B,r as D}from"./render.CP1IS3HJ.js";import{d as C,e as G}from"./definitions.tBeud579.js";import{c as U}from"./index.Bv4oCIza.js";import{B as H}from"./basic-form.CcqKlAYf.js";import{g as K}from"./model.DkhP4GoR.js";import{d as Q}from"./form-defaults.Cef9tGGx.js";import{i as W,u as w}from"./index.BPQVTpeN.js";import"./function.DiXyTdGP.js";import"./snippet.D4qn_iwt.js";import"./form.DpRxBW6A.js";import"./content.BixSG1-z.js";import"./submit-button.CjlPbjDl.js";import"./path.CI6D5hfA.js";import"./file-include.FBHbkYKS.js";import"./textarea-include.D83WNjtL.js";import"./validator.BsKEyiUz.js";function X({path:e}){return e?e.map(r=>typeof r=="object"?r.key:r):[]}function Y(e){return({issues:r},t)=>r?r.map(i=>{const n=X(i),p=C(n,e),s=G(e.uiSchema??{},n)??K(t,n)??n[n.length-1]??p;return{instanceId:p,propertyTitle:String(s),message:i.message,error:i}}):[]}function Z(e){const r=Y(e);return{validateFormValue(t,i){const n=e.schema["~standard"].validate(i);if(n instanceof Promise)throw new TypeError("Schema validation must be synchronous");return r(n,t)}}}var _;function A(e){return{lang:e?.lang??_?.lang,message:e?.message,abortEarly:e?.abortEarly??_?.abortEarly,abortPipeEarly:e?.abortPipeEarly??_?.abortPipeEarly}}var j;function S(e){return j?.get(e)}var ee;function re(e){return ee?.get(e)}var te;function ie(e,r){return te?.get(e)?.get(r)}function E(e){const r=typeof e;return r==="string"?`"${e}"`:r==="number"||r==="bigint"||r==="boolean"?`${e}`:r==="object"||r==="function"?(e&&Object.getPrototypeOf(e)?.constructor?.name)??"null":r}function d(e,r,t,i,n){const p=n&&"input"in n?n.input:t.value,s=n?.expected??e.expects??null,u=n?.received??E(p),a={kind:e.kind,type:e.type,input:p,expected:s,received:u,message:`Invalid ${r}: ${s?`Expected ${s} but r`:"R"}eceived ${u}`,requirement:e.requirement,path:n?.path,issues:n?.issues,lang:i.lang,abortEarly:i.abortEarly,abortPipeEarly:i.abortPipeEarly},l=e.kind==="schema",f=n?.message??e.message??ie(e.reference,a.lang)??(l?re(a.lang):null)??i.message??S(a.lang);f!==void 0&&(a.message=typeof f=="function"?f(a):f),l&&(t.typed=!1),t.issues?t.issues.push(a):t.issues=[a]}function c(e){return{version:1,vendor:"valibot",validate(r){return e["~run"]({value:r},A())}}}function se(e,r){const t=[...new Set(e)];return t.length>1?`(${t.join(` ${r} `)})`:t[0]??"never"}function I(e,r){return{kind:"validation",type:"max_length",reference:I,async:!1,expects:`<=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length>this.requirement&&d(this,"length",t,i,{received:`${t.value.length}`}),t}}}function g(e,r){return{kind:"validation",type:"min_length",reference:g,async:!1,expects:`>=${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&t.value.length<this.requirement&&d(this,"length",t,i,{received:`${t.value.length}`}),t}}}function q(e,r){return{kind:"validation",type:"regex",reference:q,async:!1,expects:`${e}`,requirement:e,message:r,"~run"(t,i){return t.typed&&!this.requirement.test(t.value)&&d(this,"format",t,i),t}}}function ne(e,r,t){return typeof e.fallback=="function"?e.fallback(r,t):e.fallback}function b(e,r,t){return typeof e.default=="function"?e.default(r,t):e.default}function $(e,r){return{kind:"schema",type:"array",reference:$,expects:"Array",async:!1,item:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const n=t.value;if(Array.isArray(n)){t.typed=!0,t.value=[];for(let p=0;p<n.length;p++){const s=n[p],u=this.item["~run"]({value:s},i);if(u.issues){const a={type:"array",origin:"value",input:n,key:p,value:s};for(const l of u.issues)l.path?l.path.unshift(a):l.path=[a],t.issues?.push(l);if(t.issues||(t.issues=u.issues),i.abortEarly){t.typed=!1;break}}u.typed||(t.typed=!1),t.value.push(u.value)}}else d(this,"type",t,i);return t}}}function P(e){return{kind:"schema",type:"boolean",reference:P,expects:"boolean",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="boolean"?r.typed=!0:d(this,"type",r,t),r}}}function M(e,r){return{kind:"schema",type:"object",reference:M,expects:"Object",async:!1,entries:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){const n=t.value;if(n&&typeof n=="object"){t.typed=!0,t.value={};for(const p in this.entries){const s=this.entries[p];if(p in n||(s.type==="exact_optional"||s.type==="optional"||s.type==="nullish")&&s.default!==void 0){const u=p in n?n[p]:b(s),a=s["~run"]({value:u},i);if(a.issues){const l={type:"object",origin:"value",input:n,key:p,value:u};for(const f of a.issues)f.path?f.path.unshift(l):f.path=[l],t.issues?.push(f);if(t.issues||(t.issues=a.issues),i.abortEarly){t.typed=!1;break}}a.typed||(t.typed=!1),t.value[p]=a.value}else if(s.fallback!==void 0)t.value[p]=ne(s);else if(s.type!=="exact_optional"&&s.type!=="optional"&&s.type!=="nullish"&&(d(this,"key",t,i,{input:void 0,expected:`"${p}"`,path:[{type:"object",origin:"key",input:n,key:p,value:n[p]}]}),i.abortEarly))break}}else d(this,"type",t,i);return t}}}function k(e,r){return{kind:"schema",type:"optional",reference:k,expects:`(${e.expects} | undefined)`,async:!1,wrapped:e,default:r,get"~standard"(){return c(this)},"~run"(t,i){return t.value===void 0&&(this.default!==void 0&&(t.value=b(this,t,i)),t.value===void 0)?(t.typed=!0,t):this.wrapped["~run"](t,i)}}}function T(e,r){return{kind:"schema",type:"picklist",reference:T,expects:se(e.map(E),"|"),async:!1,options:e,message:r,get"~standard"(){return c(this)},"~run"(t,i){return this.options.includes(t.value)?t.typed=!0:d(this,"type",t,i),t}}}function v(e){return{kind:"schema",type:"string",reference:v,expects:"string",async:!1,message:e,get"~standard"(){return c(this)},"~run"(r,t){return typeof r.value=="string"?r.typed=!0:d(this,"type",r,t),r}}}function m(...e){return{...e[0],pipe:e,get"~standard"(){return c(this)},"~run"(r,t){for(const i of e)if(i.kind!=="metadata"){if(r.issues&&(i.kind==="schema"||i.kind==="transformation")){r.typed=!1;break}(!r.issues||!t.abortEarly&&!t.abortPipeEarly)&&(r=i["~run"](r,t))}return r}}}function o(e,r){return e?(e.push(r),e):[r]}function x(e,r){switch(r?.errorMode){case"ignore":break;case"warn":{console.warn(e);break}default:throw new Error(e)}}function pe(e,r,t){if(t?.ignoreActions?.includes(r.type))return e;let i;switch(r.type){case"base64":{e.contentEncoding="base64";break}case"bic":case"cuid2":case"decimal":case"digits":case"emoji":case"hexadecimal":case"hex_color":case"nanoid":case"octal":case"ulid":{e.pattern=r.requirement.source;break}case"description":{e.description=r.description;break}case"email":{e.format="email";break}case"empty":{e.type==="array"?e.maxItems=0:(e.type!=="string"&&(i=o(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=0);break}case"entries":{e.minProperties=r.requirement,e.maxProperties=r.requirement;break}case"integer":{e.type="integer";break}case"ipv4":{e.format="ipv4";break}case"ipv6":{e.format="ipv6";break}case"iso_date":{e.format="date";break}case"iso_date_time":case"iso_timestamp":{e.format="date-time";break}case"iso_time":{e.format="time";break}case"length":{e.type==="array"?(e.minItems=r.requirement,e.maxItems=r.requirement):(e.type!=="string"&&(i=o(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement,e.maxLength=r.requirement);break}case"max_entries":{e.maxProperties=r.requirement;break}case"max_length":{e.type==="array"?e.maxItems=r.requirement:(e.type!=="string"&&(i=o(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.maxLength=r.requirement);break}case"max_value":{e.type!=="number"&&(i=o(i,`The "max_value" action is not supported on type "${e.type}".`)),e.maximum=r.requirement;break}case"metadata":{typeof r.metadata.title=="string"&&(e.title=r.metadata.title),typeof r.metadata.description=="string"&&(e.description=r.metadata.description),Array.isArray(r.metadata.examples)&&(e.examples=r.metadata.examples);break}case"min_entries":{e.minProperties=r.requirement;break}case"min_length":{e.type==="array"?e.minItems=r.requirement:(e.type!=="string"&&(i=o(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=r.requirement);break}case"min_value":{e.type!=="number"&&(i=o(i,`The "min_value" action is not supported on type "${e.type}".`)),e.minimum=r.requirement;break}case"multiple_of":{e.multipleOf=r.requirement;break}case"non_empty":{e.type==="array"?e.minItems=1:(e.type!=="string"&&(i=o(i,`The "${r.type}" action is not supported on type "${e.type}".`)),e.minLength=1);break}case"regex":{r.requirement.flags&&(i=o(i,"RegExp flags are not supported by JSON Schema.")),e.pattern=r.requirement.source;break}case"title":{e.title=r.title;break}case"url":{e.format="uri";break}case"uuid":{e.format="uuid";break}case"value":{e.const=r.requirement;break}default:i=o(i,`The "${r.type}" action cannot be converted to JSON Schema.`)}if(t?.overrideAction){const n=t.overrideAction({valibotAction:r,jsonSchema:e,errors:i});if(n)return{...n}}if(i)for(const n of i)x(n,t);return e}function O(e){return e.flatMap(r=>"pipe"in r?O(r.pipe):r)}let ue=0;function y(e,r,t,i,n=!1){if(!n){const s=i.referenceMap.get(r);if(s){if(e.$ref=`#/$defs/${s}`,t?.overrideRef){const u=t.overrideRef({...i,referenceId:s,valibotSchema:r,jsonSchema:e});u&&(e.$ref=u)}return e}}if("pipe"in r){const s=O(r.pipe);let u=0,a=s.length-1;if(t?.typeMode==="input"){const l=s.slice(1).findIndex(f=>f.kind==="schema"||f.kind==="transformation"&&(f.type==="find_item"||f.type==="parse_json"||f.type==="raw_transform"||f.type==="reduce_items"||f.type==="stringify_json"||f.type==="transform"));l!==-1&&(a=l)}else if(t?.typeMode==="output"){const l=s.findLastIndex(f=>f.kind==="schema");l!==-1&&(u=l)}for(let l=u;l<=a;l++){const f=s[l];f.kind==="schema"?(l>u&&x('Set the "typeMode" config to "input" or "output" to convert pipelines with multiple schemas.',t),e=y(e,f,t,i,!0)):e=pe(e,f,t)}return e}let p;switch(r.type){case"boolean":{e.type="boolean";break}case"null":{e.type="null";break}case"number":{e.type="number";break}case"string":{e.type="string";break}case"array":{e.type="array",e.items=y({},r.item,t,i);break}case"tuple":case"tuple_with_rest":case"loose_tuple":case"strict_tuple":{e.type="array",e.items=[],e.minItems=r.items.length;for(const s of r.items)e.items.push(y({},s,t,i));r.type==="tuple_with_rest"?e.additionalItems=y({},r.rest,t,i):r.type==="strict_tuple"&&(e.additionalItems=!1);break}case"object":case"object_with_rest":case"loose_object":case"strict_object":{e.type="object",e.properties={},e.required=[];for(const s in r.entries){const u=r.entries[s];e.properties[s]=y({},u,t,i),u.type!=="nullish"&&u.type!=="optional"&&e.required.push(s)}r.type==="object_with_rest"?e.additionalProperties=y({},r.rest,t,i):r.type==="strict_object"&&(e.additionalProperties=!1);break}case"record":{"pipe"in r.key&&(p=o(p,'The "record" schema with a schema for the key that contains a "pipe" cannot be converted to JSON Schema.')),r.key.type!=="string"&&(p=o(p,`The "record" schema with the "${r.key.type}" schema for the key cannot be converted to JSON Schema.`)),e.type="object",e.additionalProperties=y({},r.value,t,i);break}case"any":case"unknown":break;case"nullable":case"nullish":{e.anyOf=[y({},r.wrapped,t,i),{type:"null"}],r.default!==void 0&&(e.default=b(r));break}case"exact_optional":case"optional":case"undefinedable":{e=y(e,r.wrapped,t,i),r.default!==void 0&&(e.default=b(r));break}case"literal":{typeof r.literal!="boolean"&&typeof r.literal!="number"&&typeof r.literal!="string"&&(p=o(p,'The value of the "literal" schema is not JSON compatible.')),e.const=r.literal;break}case"enum":{e.enum=r.options;break}case"picklist":{r.options.some(s=>typeof s!="number"&&typeof s!="string")&&(p=o(p,'An option of the "picklist" schema is not JSON compatible.')),e.enum=r.options;break}case"union":case"variant":{e.anyOf=r.options.map(s=>y({},s,t,i));break}case"intersect":{e.allOf=r.options.map(s=>y({},s,t,i));break}case"lazy":{let s=i.getterMap.get(r.getter);s||(s=r.getter(void 0),i.getterMap.set(r.getter,s));let u=i.referenceMap.get(s);if(u||(u=`${ue++}`,i.referenceMap.set(s,u),i.definitions[u]=y({},s,t,i,!0)),e.$ref=`#/$defs/${u}`,t?.overrideRef){const a=t.overrideRef({...i,referenceId:u,valibotSchema:s,jsonSchema:e});a&&(e.$ref=a)}break}default:p=o(p,`The "${r.type}" schema cannot be converted to JSON Schema.`)}if(t?.overrideSchema){const s=t.overrideSchema({...i,referenceId:i.referenceMap.get(r),valibotSchema:r,jsonSchema:e,errors:p});if(s)return{...s}}if(p)for(const s of p)x(s,t);return e}let ae;function fe(){return ae}function le(e,r){const t={definitions:{},referenceMap:new Map,getterMap:new Map},i=r?.definitions??fe();if(i){for(const p in i)t.referenceMap.set(i[p],p);for(const p in i)t.definitions[p]=y({},i[p],r,t,!0)}const n=y({$schema:"http://json-schema.org/draft-07/schema#"},e,r,t);return t.referenceMap.size&&(n.$defs=t.definitions),n}var ye=L("<!> <pre> </pre>",1);function Te(e,r){h(r,!0);const t=M({id:k(m(v(),q(new RegExp("^\\d+$"),"Must be a number"),g(8))),active:k(P()),skills:k(m($(m(v(),g(5))),g(4))),multipleChoicesList:k(m($(T(["foo","bar","fuzz"])),I(2)))}),i={...Z({schema:t,uiSchema:w}),isValid:()=>!0},n=U({...Q,schema:le(t,{}),uiSchema:w,validator:i,initialValue:W});var p=ye(),s=J(p);H(s,{get form(){return n},novalidate:!0});var u=F(s,2),a=B(u,!0);D(u),R(l=>z(a,l),[()=>JSON.stringify(n.value,null,2)]),N(e,p),V()}export{Te as default};
