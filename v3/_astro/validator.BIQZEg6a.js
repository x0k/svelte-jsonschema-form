import{ab as F,ai as oe,aj as se,ak as ce,al as N,am as ue,an as le,ao as de,ap as U,M as fe,aq as me,ar as pe,p as S,k as C,Y as ge,l as W,Z as be,_ as ye,$ as ve,t as B,a0 as _e,a1 as Ae,s as he,r as Fe,a2 as Se,as as Oe,at as Ee,ac as Re,ad as H,ae as Y,P as we,au as xe}from"./definitions.CQdNrImE.js";import{e as Te}from"./each.B6EQyiei.js";import{p as O,m as T,d as k,b as A,a as E,g,u as _,_ as ke,f as I,aI as Ve,c as Ce,s as Me,r as Pe,t as De,e as Ie}from"./render.p9uU9aNd.js";import{b as Le,c as G}from"./ajv.XFQD3mfp.js";import{s as je}from"./snippet.CRTjy3CY.js";import{c as Ne,h as Ue,d as L,b as We}from"./file.DTwbteRD.js";import{j as Be,w as He,g as j,x as Ye,i as K,e as Ge,m as Ke,f as qe}from"./en.C0RQhfxi.js";function V(e,t,n={type:"root",path:[]}){if(!F(e))return t(e,n);const a={...e};for(const i of oe){const c=e[i];if(c===void 0||!Array.isArray(c))continue;const o={type:"array",parent:e,key:i,index:0,path:n.path.concat(i,0)};a[i]=c.map((d,l)=>(o.index=l,o.path[o.path.length-1]=l,V(d,t,o)))}const r=new Map;for(const i of se){const c=e[i];if(c===void 0)continue;const o={type:"record",parent:e,key:i,property:"",path:n.path.concat(i,"")},d=Object.keys(c),l=d.length;for(let f=0;f<l;f++){const m=d[f],p=c[m];if(Array.isArray(p)){r.set(m,p);continue}o.property=m,o.path[o.path.length-1]=m,r.set(m,V(p,t,o))}a[i]=Object.fromEntries(r),r.clear()}const s={type:"sub",parent:e,key:"items",path:n.path.concat("")};for(const i of ce){const c=e[i];c===void 0||Array.isArray(c)||(s.key=i,s.path[s.path.length-1]=i,a[i]=V(c,t,s))}return t(a,n)}function ze(e,t){return V(e,n=>{if(!F(n))return n;const a=n[N];return a!==void 0&&a.startsWith("#")&&(n[N]=`${t}${a}`),n})}function q(e){return e.split("/").slice(1).map(t=>t.replace(/~1/g,"/").replace(/~0/g,"~"))}function Et(e){if(e==="#")return[];const t=q(e);let n=!1;return t.map(a=>{if(n){const r=Number(a);if(Number.isInteger(r)&&r>=0)return n=!1,r}return n=ue.has(a),a})}function Xe(e,t){const n=[];if(e==="")return n;const a=q(e);let r=t;for(const s of a)if(Array.isArray(r)&&/^\d+$/.test(s)){const i=Number(s);n.push(i),r=r[i]}else n.push(s),r=r?.[s];return n}function Rt(e,t,n,a,r,s){function i(o,d,l,f){const m=o.map(y=>typeof y=="boolean"?y?{}:{not:{}}:y),p=me(e,t,n,f,m,-1,pe(d)),b=c(m[p],l,f);if(b!==void 0)return b;let u;for(const y of m){if(!F(y))continue;const v=c(y,l,f);if(v!==void 0){if(F(v))return v;u=v}}return u}function c(o,d,l){for(let f=0;f<d.length;f++){if(o===void 0||!F(o))return;if(o.$ref)return c(le(o.$ref,n),d.slice(f),l);if(o.allOf){const u=t.mergeAllOf(o);if(!u.allOf)return c(u,d.slice(f),l)}const m=o.anyOf??o.oneOf??o.allOf;if(m){const u=i(m,o,d.slice(f),l);if(u!==void 0)return u}const p=d[f],b=typeof p;if(b==="number"){const{items:u,additionalItems:y}=o;o=(Array.isArray(u)?u[p]:u)??y,l=de(l)?l[p]:void 0;continue}if(b==="string"){const{properties:u,patternProperties:y,additionalProperties:v,dependencies:M,then:h,else:R}=o;o=(u&&u[p])??(y&&Object.entries(y).find(([P])=>new RegExp(P).test(p))?.[1])??v??(M&&i(Object.values(M).filter(U),o,d.slice(f),l))??((h||R)&&i([h,R].filter(U),o,d.slice(f),l)),l=fe(l)?l[p]:void 0;continue}return}return o}return c(a,r,s)}const Je="nativeFileField";function Ze(e,t){O(t,!0);const n=b=>{var u=T(),y=k(u);je(y,()=>g(f)??ke,()=>r,()=>t.config,()=>({get current(){return a()},set current(v){a(v)}}),()=>g(d)),A(b,u)};let a=S(t,"value",15);const r=C(),s=_(()=>B(r,"fieldTemplate",t.config)),i="fileWidget",c=_(()=>B(r,i,t.config)),o=ge(r,()=>t.config,()=>be(r,t.config,a())),d=_(()=>_e(r,t.config.path)),l=Ne({combinator:Ue,async execute(b,u){if(!(u===void 0||u.length===0)){if(!await ye(b,r,t.config,u))throw new ve;return u[0]}},onSuccess(b){a(b)}}),f=_(()=>Ae(r,t.config,Je));var m=T(),p=k(m);{let b=_(()=>g(f)&&n);W(p,()=>g(s),(u,y)=>{y(u,{type:"template",showTitle:!0,useLabel:!0,get uiOption(){return t.uiOption},widgetType:i,get value(){return a()},get config(){return t.config},get errors(){return g(d)},get action(){return g(b)},children:(v,M)=>{var h=T(),R=k(h),P=()=>{const w=a(),x=new DataTransfer;return w&&x.items.add(w),x.files},ae=l.run;W(R,()=>g(c),(w,x)=>{x(w,{type:"widget",get value(){return P()},set value(ie){ae(ie)},get processing(){return l.isProcessed},loading:!1,get uiOption(){return t.uiOption},get handlers(){return o},get errors(){return g(d)},get config(){return t.config},multiple:!1})}),A(v,h)},$$slots:{default:!0}})})}A(e,m),E()}function Qe(e,t){O(t,!0);let n=S(t,"value",15),a=Fe(t,["$$slots","$$events","$$legacy","value"]);var r=()=>(Le(n()),n()),s=i=>{n(i)};Ze(e,he({get value(){return r()},set value(i){s(i)}},()=>a)),E()}Se.unknownNativeFileField=Qe;var $e=I("<textarea></textarea>");function et(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>He(a,t.config,"textarea",t.handlers,{style:"flex-grow: 1;"}));var s=$e();Ve(s),L(s,()=>({...g(r)})),Be(s,n),A(e,s),E()}j.textareaWidget=et;var tt=I("<input/>");function nt(e,t){O(t,!0);let n=S(t,"value",15);const a=C(),r=_(()=>K(a,t.config,"file",t.handlers,{multiple:t.multiple,style:"flex-grow: 1","data-loading":t.loading,"data-processing":t.processing}));var s=tt();L(s,()=>({type:"file",...g(r)}),void 0,void 0,void 0,!0),Ye(s,n),A(e,s),E()}j.fileWidget=nt;var rt=I('<label class="svelte-tmopj2"><input/> </label>');const at={hash:"svelte-tmopj2",code:"label.svelte-tmopj2 {display:flex;align-items:start;gap:0.2rem;}"};function it(e,t){O(t,!0),We(e,at);const n=[];let a=S(t,"value",15);const r=C(),s=_(()=>K(r,t.config,"checkboxes",t.handlers,{type:"checkbox"})),i=Ke({mapper:()=>qe(t.options),value:()=>a(),update:d=>a(d)});var c=T(),o=k(c);Te(o,19,()=>t.options,d=>d.id,(d,l,f)=>{var m=rt(),p=Ce(m);L(p,()=>({value:g(f),...g(s),id:g(l).id,disabled:g(l).disabled||g(s).disabled}),void 0,void 0,void 0,!0);var b=Me(p);Pe(m),De(()=>Ie(b,` ${g(l).label??""}`)),Ge(n,[],p,()=>(g(f),i.value),u=>i.value=u),A(d,m)}),A(e,c),E()}j.checkboxesWidget=it;const ot={allErrors:!0,multipleOfPrecision:8,strict:!1,verbose:!0,discriminator:!0},st=/^(#?([0-9A-Fa-f]{3}){1,2}\b|aqua|black|blue|fuchsia|gray|green|lime|maroon|navy|olive|orange|purple|red|silver|teal|white|yellow|(rgb\(\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*,\s*\b([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\b\s*\))|(rgb\(\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*,\s*(\d?\d%|100%)+\s*\)))$/,ct=/^data:([a-z]+\/[a-z0-9-+.]+)?;(?:name=(.*);)?base64,(.*)$/;function ut(e){return e.addFormat("color",st),e.addFormat(Ee,ct),e}function lt(e){return e.addKeyword(Oe),e}function dt(e){return lt(ut(e))}function D(e,t){let n="",a=!1;const r=new WeakMap,s=Y(r,i=>{let c=i;return a&&(c=ze(i,n),delete c[H]),e.compile(c)});return(i,c)=>{n=c[H]??Re;let o=e.getSchema(n)?.schema;return o!==void 0&&o!==c&&(e.removeSchema(n),r.delete(i),o=void 0),o===void 0&&e.addSchema(c,n),a=i!==c,s(i)}}function z(e,t){const a=Y(new WeakMap,r=>e.compile({...r,$async:t}));return r=>a(r.schema)}function ft({params:{missingProperty:e,propertyName:t},propertyName:n=t},a){let r=a;return r=e!==void 0?a.concat(e):r,r=n!==void 0?a.concat(n,we("key-input")):r,r}function X({params:{missingProperty:e},parentSchema:t,message:n},a){if(!n)return"";if(e===void 0)return n;const r=a(e,t);return r===void 0?n:n.replace(e,r)}function J({uiSchema:e={}}){return(t,n)=>({value:n,errors:t.map(a=>{const r=Xe(a.instancePath,n);return{path:ft(a,r),message:X(a,(s,i)=>{const c=xe(e,r.concat(s));if(c!==void 0)return c;const o=i?.properties?.[s];if(typeof o=="object")return o.title})}})})}function Z(e){return e.instancePath===""}function mt(e){return Z(e)&&e.keyword!=="type"}function Q(e){return t=>t.filter(e.required?Z:mt).map(n=>X(n,()=>e.title))}function $(e,t,n,a){e(t);const r=e.errors;return e.errors=null,r?a(r,t):n(t)}async function ee(e,t,n,a){try{await e(t)}catch(r){if(!(r instanceof G.Ajv.ValidationError))throw r;return a(r.errors,t)}finally{e.errors=null}return n(t)}const te=e=>({value:e}),ne=()=>[];function re({compileSchema:e}){return{isValid(t,n,a){if(typeof t=="boolean")return t;const r=e(t,n);try{return r(a)}catch(s){return console.warn("Failed to validate",s),!1}}}}function pt(e){const t=J(e);return{validateFormValue(n,a){return $(e.compileSchema(n,n),a,te,t)}}}function gt({compileFieldSchema:e}){return{validateFieldValue(t,n){return $(e(t),n,ne,Q(t))}}}function bt(e){const t=J(e);return{async validateFormValueAsync(n,a,r){return ee(e.compileAsyncSchema(a,a),r,te,t)}}}function yt({compileAsyncFieldSchema:e}){return{async validateFieldValueAsync(t,n,a){return ee(e(n),a,ne,Q(n))}}}function wt({ajvOptions:e=ot,ajvPlugins:t=dt,ajv:n=t(new G.Ajv(e)),compileSchema:a=D(n),compileFieldSchema:r=z(n,!1),...s}={}){const i={...s,compileSchema:a,compileFieldSchema:r};return Object.assign(re(i),pt(i),gt(i))}function xt({ajv:e,compileSchema:t=D(e),compileAsyncSchema:n=D(e),compileAsyncFieldSchema:a=z(e,!0),...r}){const s={...r,compileSchema:t,compileAsyncSchema:n,compileAsyncFieldSchema:a};return Object.assign(re(s),bt(s),yt(s))}export{te as C,ne as N,dt as a,xt as b,wt as c,Et as d,J as e,Q as f,Rt as g,ze as h,Xe as p,$ as v};
