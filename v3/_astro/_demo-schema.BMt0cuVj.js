import{e as G}from"./checkboxes-include.iOd6DJNW.js";import{t as Q,e as X,n as Y,f as tt,a as et,u as nt,b as it,c as ot,F as st,d as rt}from"./legacy.D4mIJFqN.js";import"./file-include.BWrWKku1.js";import"./_commonjsHelpers.DWjMLJnj.js";import"./definitions.15afNNW8.js";import"./JSONArrow_svelte_svelte_type_style_lang.74958d3e.l0sNRNKZ.js";import"./JSONNested_svelte_svelte_type_style_lang.3c95b736.l0sNRNKZ.js";import"./PreviewList_svelte_svelte_type_style_lang.08ca2152.l0sNRNKZ.js";import"./JSONValueNode_svelte_svelte_type_style_lang.253f11b4.l0sNRNKZ.js";import"./ErrorStack_svelte_svelte_type_style_lang.d411949f.l0sNRNKZ.js";import"./JSONStringNode_svelte_svelte_type_style_lang.c4a2a02c.l0sNRNKZ.js";import"./JSONFunctionNode_svelte_svelte_type_style_lang.ceef42f6.l0sNRNKZ.js";import"./RegExpNode_svelte_svelte_type_style_lang.0aa802f4.l0sNRNKZ.js";import"./Root_svelte_svelte_type_style_lang.f7adc256.l0sNRNKZ.js";import"./form_svelte_svelte_type_style_lang.dc4a961f.l0sNRNKZ.js";import"./shared.CNmXlSTg.js";const ct=G(st,{value:{transform(t){return ot(t.value),t.value}}}),Ut={checkbox:[it,{},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],checkboxes:[nt,{"ui:components":{arrayField:"multiEnumField"}},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],file:[et,{"ui:components":{stringField:"fileField"}},{onchange:"changeFile",onblur:"visitFile"}],multiFile:[tt,{"ui:components":{arrayField:ct}},{onchange:"changeFile",onblur:"visitFile"}],number:[Y,{},{oninput:"inputNumber",onchange:"changeNumber",onblur:"visitNumber"}],select:[X,{"ui:components":{stringField:"enumField"}},{oninput:"inputSelect",onchange:"changeSelect",onblur:"visitSelect"}],text:[Q,{},{oninput:"inputText",onchange:"changeText",onblur:"visitText"}]},F=(t,e)=>Array.from(new Array(t),(i,n)=>e(n));function O(t,e){for(let i=0;i<t.length;i++)t[i]+=e}function lt({rows:t,indexes:e},i){for(let n=0;n<t.length;n++){e[n]=e[n]*i;const o=t[n].cells;for(let r=0;r<o.length;r++)o[r].height=o[r].height*i}}function ht({rows:t},e){for(let i=0;i<t.length;i++){const{cells:n,columns:o}=t[i];for(let r=0;r<n.length;r++)n[r].width=n[r].width*e,o[r]=o[r]*e}}const j=(t,e)=>t>e?t:e,D=(t,e)=>t?D(e%t,t):e,v=(t,e)=>t*e/D(t,e);function at({blocks:t,width:e,heightIsLcm:i=!0,height:n,widthIsLcm:o=!0}){const r=t.map(l=>{const s=o?e/l.width:1,c=i?n/l.height:1,{rows:h,indexes:u}=l.data,d=F(n,()=>new Array(e));for(let g=0;g<h.length;g++){const p=u[g],{cells:k,columns:S}=h[g];for(let a=0;a<k.length;a++){const w=k[a],f=p*c;let m=f+w.height*c;!i&&m===l.height&&m<n&&(m=n);const x=S[a]*s;let I=x+w.width*s;!o&&I===l.width&&I<e&&(I=e);for(let y=f;y<m;y++){const P=d[y];for(let T=x;T<I;T++)P[T]=w}}}return d});for(let l=0;l<n;l++){const s=r[0][l];for(let c=0;c<e;c++){const h=s[c];for(let u=1;u<t.length;u++){const d=r[u][l][c];if(!d||h.value!==d.value)return!1}}l++}return!0}function Z({rows:t},e,i){for(const[n,o]of e){const r=t[n].cells;for(const[l,s]of o)r[l][i]+=s}}function ut({data:t,height:e,width:i}){const n=F(i,()=>0),o=new Array(i),{rows:r}=t;for(let s=0;s<r.length;s++){const{cells:c,columns:h}=r[s];for(let u=0;u<c.length;u++){const d=c[u],g=h[u];n[g]+=d.height,o[g]={cell:d,rowIndex:s,colIndex:u};for(let p=1;p<d.width;p++)n[g+p]+=d.height,o[g+p]=null}}const l=new Map;for(let s=0;s<i;s++){const c=o[s];if(!c)continue;const h=e-n[s];if(h<=0)continue;const u=l.get(c.rowIndex)||new Map;l.set(c.rowIndex,u.set(c.colIndex,h))}Z(t,l,"height")}function dt({data:t,height:e,width:i}){const n=new Array(e),{rows:o,indexes:r}=t;for(let c=0;c<o.length;c++){const{cells:h,columns:u}=o[c];if(h.length===0)continue;const d=h.length-1,g=h[d],p=u[d]+g.width,k={cell:g,indexInRow:d,xTopRightCorner:p},S=r[c];for(let a=S;a<S+g.height;a++){const w=n[a];(!w||p>w.xTopRightCorner)&&(n[a]=k)}}const l=new Set,s=new Map;for(let c=0;c<o.length;c++){const h=r[c],u=n[h];if(!u||l.has(u.cell))continue;l.add(u.cell);const d=i-u.xTopRightCorner;if(d<=0)continue;const g=s.get(c)||new Map;s.set(c,g.set(u.indexInRow,d))}Z(t,s,"width")}const ft={width:ht,height:lt},gt={width:dt,height:ut};function L(t,e){const i=ft[t],n=gt[t];return o=>{const r=Math.floor(e/o[t]);r>1&&i(o.data,r);let l=o[t];o[t]=e,e-l*r>0&&n(o)}}function B(t,e){const i=new Array(0),n=new Array(0);let o=0;for(let r=0;r<t.length;r++){const{data:l,height:s}=t[r];for(let c=0;c<l.rows.length;c++)n.push(o+l.indexes[c]),i.push(l.rows[c]);o+=s}return{width:e,height:o,data:{rows:i,indexes:n}}}function wt(t){const e=new Array(t.length);let i=0;for(let n=0;n<t.length;n++){if(t[n].cells.length===0){i++;continue}t[n-i]=t[n],e[n-i]=n}return t.length-=i,e.length-=i,e}function M(t,e){const i=F(e,()=>({cells:[],columns:[]}));let n=0;for(let r=0;r<t.length;r++){const{data:{rows:l,indexes:s},width:c}=t[r];for(let h=0;h<l.length;h++){const{cells:u,columns:d}=l[h],g=i[s[h]];for(let p=0;p<u.length;p++)g.cells.push(u[p]),g.columns.push(d[p]+n)}n+=c}const o=wt(i);return{width:n,height:e,data:{rows:i,indexes:o}}}function mt(t){return function(i){let n=i[0].width,o=n;for(let s=1;s<i.length;s++){const c=i[s];n=v(n,c.width),o=j(o,c.width)}const r=t(n,o)?n:o,l=L("width",r);for(let s=0;s<i.length;s++)l(i[s]);return B(i,r)}}function pt(t){return e=>{let i=e[0].height,n=i;for(let l=1;l<e.length;l++)i=v(i,e[l].height),n=j(n,e[l].height);const o=t(i,n)?i:n,r=L("height",o);for(let l=0;l<e.length;l++)r(e[l]);return M(e,o)}}var R;(function(t){t.Header="header",t.Index="index",t.Value="value",t.Corner="corner"})(R||(R={}));const xt={head:"height",indexes:"width"},q={head:"indexes",indexes:"head"};function _(t){return{head:null,indexes:null,body:{height:1,width:1,data:{rows:[{cells:[{height:1,width:1,value:t,type:R.Value}],columns:[0]}],indexes:[0]}}}}function kt(t,e){return t.width===e.width?t.height<e.height?t:e:t.width>e.width?t:e}function yt(t,e){return t.height===e.height?t.width<e.width?t:e:t.height>e.height?t:e}const It={head:kt,indexes:yt};function Pt(t,e,i){const{[e]:n}=t[0];if(!n)return null;const o=It[e],r=[n];let l=n,s=n.height,c=n.width,h=n.height,u=n.width;for(let p=1;p<t.length;p++){const k=t[p][e];if(!k)return null;l=o(l,k),h=j(h,k.height),u=j(u,k.width),s=v(s,k.height),c=v(c,k.width),r.push(k)}const d=i(s,h),g=i(c,u);return!(e==="head"?d:g)||!at({blocks:r,width:g?c:u,widthIsLcm:g,height:d?s:h,heightIsLcm:d})?null:l}function K({head:t,indexes:e,cornerCellValue:i}){return({body:n,head:o,indexes:r})=>{if(!t&&!e)return n;const l=t&&o!==null,s=e&&r!==null,c=s?M([r,n],n.height):n,h=n.width+(s?r.width:0);if(!l)return c;if(!s)return B([o,c],h);for(let d=0;d<o.data.rows.length;d++)O(o.data.rows[d].columns,r.width);const u=o.data.rows[0];return u.cells.unshift({height:o.height,width:r.width,value:i,type:R.Corner}),u.columns.unshift(0),B([o,c],h)}}function Tt(t,e,i,n){const o=[];for(let r=0;r<t.length;r++){const l=t[r],{[e]:s,[q[e]]:c}=l;if(s===null)return null;if(!i||!c){o.push(s);continue}switch(e){case"indexes":{const h=s.data.indexes.slice();O(h,c.height),h.unshift(0),o.push({height:s.height+c.height,width:s.width,data:{rows:[{cells:[{height:c.height,width:s.width,value:n,type:R.Corner}],columns:[0]},...s.data.rows],indexes:h}});break}case"head":{const h=s.data.rows[0].columns.slice();O(h,c.width),h.unshift(0),o.push({height:s.height,width:s.width+c.width,data:{rows:[{cells:[{height:s.height,width:c.width,value:n,type:R.Corner},...s.data.rows[0].cells],columns:h},...s.data.rows.slice(1)],indexes:s.data.indexes}});break}default:throw new Error(`Unknown table component: ${e}`)}}return o}const St={head:mt,indexes:pt};function z({deduplicationComponent:t,isProportionalResize:e,cornerCellValue:i}){const n=St[t](e),o=q[t];return r=>{const l=Pt(r,t,e),s=l===null,c=Tt(r,o,s,i),h=r.map(K({[t]:s,[o]:c===null,cornerCellValue:i})),u=n(h),d=xt[o];return l&&L(d,u[d])(l),{body:u,baked:h,[t]:l,[o]:c&&n(c)}}}const $=t=>t===null||typeof t!="object";function Ct(t){return typeof t=="object"&&t!==null}function Rt(t){return Ct(t)&&!Array.isArray(t)}function H(t,e){return t===void 0?e:(e.value<t.value?t.left=H(t.left,e):t.right=H(t.right,e),t)}function N(t,e){t!==void 0&&(N(t.left,e),e(t),N(t.right,e))}function At(){let t=0;const e={};return i=>{const n=Object.entries(i);let o;for(const[s,c]of n){const h=e[s]??={key:s,val:c,value:t++};h.val=c,h.left=void 0,h.right=void 0,o=H(o,h)}const r=[],l=[];return N(o,s=>{r.push(s.key),l.push(s.val)}),[r,l]}}function Et(t){return(e,i)=>(e-i)/i<=t}function _t({cornerCellValue:t,joinPrimitiveArrayValues:e,combineArraysOfObjects:i,proportionalSizeAdjustmentThreshold:n=1,collapseIndexes:o,stabilizeOrderOfPropertiesInArraysOfObjects:r=!0}){const l=Et(n),s=z({deduplicationComponent:"head",isProportionalResize:l,cornerCellValue:t}),c=z({deduplicationComponent:"indexes",isProportionalResize:l,cornerCellValue:t});function h(a,w){const{baked:f,indexes:m}=a,x=m!==null;if(x&&o){let C=0,A=f[0].height;const{rows:E,indexes:U}=m.data;for(let b=0;b<E.length;b++){const W=E[b];U[b]>=A&&(A+=f[++C].height);const J=w[C];W.cells[0].value=`${J}.${W.cells[0].value}`}return}const y=F(f.length,()=>({cells:[],columns:[]})),P=new Array(0);let T=0;for(let C=0;C<f.length;C++){const A=y[C],{height:E}=f[C];A.cells.push({height:E,width:1,value:w[C],type:R.Index}),A.columns.push(0),P.push(T),T+=E}const V={height:T,width:1,data:{rows:y,indexes:P}};a.indexes=x?M([V,m],T):V}function u(a,w){const{baked:f,head:m}=a,x=m!==null,I={cells:[],columns:[]};let y=0;for(let P=0;P<f.length;P++){const{width:T}=f[P];I.cells.push({height:1,width:T,value:w[P],type:R.Header}),I.columns.push(y),y+=T}x&&(m.data.rows.unshift(I),O(m.data.indexes,1),m.data.indexes.unshift(0)),a.head={width:y,height:x?m.height+1:1,data:x?m.data:{rows:[I],indexes:[0]}}}function d(a,w){const f=s(w);return h(f,a),delete f.baked,f}function g(a,w){const f=c(w);return u(f,a),delete f.baked,f}function p(a){const w=Object.keys(a);return w.length===0?_(""):g(w,w.map(f=>S(a[f])))}function k(a,w){const f=new Array(a.length),m=new Array(a.length);for(let x=0;x<a.length;x++)f[x]=String(x+1),m[x]=w(a[x]);return d(f,m)}function S(a){if($(a))return _(a);if(Array.isArray(a)){if(a.length===0)return _("");let w=!0,f=!0,m=0;for(;m<a.length&&(w||f);)w=w&&$(a[m]),f=f&&Rt(a[m]),m++;if(w)return _(a.join(", "));if(i&&f)return p(Object.assign({},...a));if(r&&f){const x=At();return k(a,I=>{const[y,P]=x(I);return y.length===0?_(""):g(y,P.map(S))})}return k(a,S)}return p(a)}return S}function bt(t){const e=_t(t),i=K({cornerCellValue:t.cornerCellValue,head:!0,indexes:!0});return n=>i(e(n))}function Jt(t={}){const e={};for(const[o,r]of Object.entries(t))e[o]=r.with(1,{...r[1],"ui:options":{...r[1]["ui:options"],title:o}});const i=rt(e),n=i.uiSchema;for(const o of Object.keys(n))n[o]={...n[o],"ui:options":{...n[o]?.["ui:options"],layouts:{"object-properties":{style:"display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;"}}}};return i}bt({cornerCellValue:"â„–",joinPrimitiveArrayValues:!0});export{Ut as D,Jt as c};
