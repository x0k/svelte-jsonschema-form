import{t as G,e as Q,n as X,f as Y,a as tt,u as et,b as nt,c as it,F as ot,d as st}from"./legacy.I47LKkzk.js";import"./multi-enum-include.Df7ZNjXz.js";import"./file-include.BBzPsHw6.js";import"./each.fmg2rbnc.js";import"./definitions.QuHyn0Ht.js";import"./JSONArrow_svelte_svelte_type_style_lang.a1599035.l0sNRNKZ.js";import"./JSONNested_svelte_svelte_type_style_lang.fd22bc41.l0sNRNKZ.js";import"./PreviewList_svelte_svelte_type_style_lang.5dcdbcb5.l0sNRNKZ.js";import"./JSONValueNode_svelte_svelte_type_style_lang.a6137416.l0sNRNKZ.js";import"./ErrorStack_svelte_svelte_type_style_lang.ca573138.l0sNRNKZ.js";import"./JSONStringNode_svelte_svelte_type_style_lang.bacee525.l0sNRNKZ.js";import"./JSONFunctionNode_svelte_svelte_type_style_lang.c631ed6b.l0sNRNKZ.js";import"./RegExpNode_svelte_svelte_type_style_lang.43633d65.l0sNRNKZ.js";import"./Root_svelte_svelte_type_style_lang.001671e9.l0sNRNKZ.js";import"./form_svelte_svelte_type_style_lang.dc4a961f.l0sNRNKZ.js";import"./shared.CgU1RUzM.js";function rt(t,e){return function(i,n){const o=new Proxy(n,{get(s,c,r){const l=e[c];if(l!==void 0){const{transform:h}=l;if(h!==void 0)return h(s)}return Reflect.get(s,c,r)},set(s,c,r,l){const h=e[c];if(h!==void 0&&"recover"in h){const{recover:a}=h;if(a!==void 0)return a(s,r),!0}return Reflect.set(s,c,r,l)},has(s,c){return Reflect.has(s,c)||e?.[c]?.transform!==void 0}});return t(i,o)}}const ct=rt(ot,{value:{transform(t){return it(t.value),t.value}}}),Ut={checkbox:[nt,{},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],checkboxes:[et,{"ui:components":{arrayField:"multiEnumField"}},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],file:[tt,{"ui:components":{stringField:"fileField"}},{onchange:"changeFile",onblur:"visitFile"}],multiFile:[Y,{"ui:components":{arrayField:ct}},{onchange:"changeFile",onblur:"visitFile"}],number:[X,{},{oninput:"inputNumber",onchange:"changeNumber",onblur:"visitNumber"}],select:[Q,{"ui:components":{stringField:"enumField"}},{oninput:"inputSelect",onchange:"changeSelect",onblur:"visitSelect"}],text:[G,{},{oninput:"inputText",onchange:"changeText",onblur:"visitText"}]},F=(t,e)=>Array.from(new Array(t),(i,n)=>e(n));function O(t,e){for(let i=0;i<t.length;i++)t[i]+=e}function lt({rows:t,indexes:e},i){for(let n=0;n<t.length;n++){e[n]=e[n]*i;const o=t[n].cells;for(let s=0;s<o.length;s++)o[s].height=o[s].height*i}}function ht({rows:t},e){for(let i=0;i<t.length;i++){const{cells:n,columns:o}=t[i];for(let s=0;s<n.length;s++)n[s].width=n[s].width*e,o[s]=o[s]*e}}const j=(t,e)=>t>e?t:e,D=(t,e)=>t?D(e%t,t):e,v=(t,e)=>t*e/D(t,e);function at({blocks:t,width:e,heightIsLcm:i=!0,height:n,widthIsLcm:o=!0}){const s=t.map(c=>{const r=o?e/c.width:1,l=i?n/c.height:1,{rows:h,indexes:a}=c.data,d=F(n,()=>new Array(e));for(let g=0;g<h.length;g++){const p=a[g],{cells:k,columns:S}=h[g];for(let u=0;u<k.length;u++){const w=k[u],f=p*l;let m=f+w.height*l;!i&&m===c.height&&m<n&&(m=n);const x=S[u]*r;let P=x+w.width*r;!o&&P===c.width&&P<e&&(P=e);for(let y=f;y<m;y++){const I=d[y];for(let T=x;T<P;T++)I[T]=w}}}return d});for(let c=0;c<n;c++){const r=s[0][c];for(let l=0;l<e;l++){const h=r[l];for(let a=1;a<t.length;a++){const d=s[a][c][l];if(!d||h.value!==d.value)return!1}}c++}return!0}function Z({rows:t},e,i){for(const[n,o]of e){const s=t[n].cells;for(const[c,r]of o)s[c][i]+=r}}function ut({data:t,height:e,width:i}){const n=F(i,()=>0),o=new Array(i),{rows:s}=t;for(let r=0;r<s.length;r++){const{cells:l,columns:h}=s[r];for(let a=0;a<l.length;a++){const d=l[a],g=h[a];n[g]+=d.height,o[g]={cell:d,rowIndex:r,colIndex:a};for(let p=1;p<d.width;p++)n[g+p]+=d.height,o[g+p]=null}}const c=new Map;for(let r=0;r<i;r++){const l=o[r];if(!l)continue;const h=e-n[r];if(h<=0)continue;const a=c.get(l.rowIndex)||new Map;c.set(l.rowIndex,a.set(l.colIndex,h))}Z(t,c,"height")}function dt({data:t,height:e,width:i}){const n=new Array(e),{rows:o,indexes:s}=t;for(let l=0;l<o.length;l++){const{cells:h,columns:a}=o[l];if(h.length===0)continue;const d=h.length-1,g=h[d],p=a[d]+g.width,k={cell:g,indexInRow:d,xTopRightCorner:p},S=s[l];for(let u=S;u<S+g.height;u++){const w=n[u];(!w||p>w.xTopRightCorner)&&(n[u]=k)}}const c=new Set,r=new Map;for(let l=0;l<o.length;l++){const h=s[l],a=n[h];if(!a||c.has(a.cell))continue;c.add(a.cell);const d=i-a.xTopRightCorner;if(d<=0)continue;const g=r.get(l)||new Map;r.set(l,g.set(a.indexInRow,d))}Z(t,r,"width")}const ft={width:ht,height:lt},gt={width:dt,height:ut};function L(t,e){const i=ft[t],n=gt[t];return o=>{const s=Math.floor(e/o[t]);s>1&&i(o.data,s);let c=o[t];o[t]=e,e-c*s>0&&n(o)}}function B(t,e){const i=new Array(0),n=new Array(0);let o=0;for(let s=0;s<t.length;s++){const{data:c,height:r}=t[s];for(let l=0;l<c.rows.length;l++)n.push(o+c.indexes[l]),i.push(c.rows[l]);o+=r}return{width:e,height:o,data:{rows:i,indexes:n}}}function wt(t){const e=new Array(t.length);let i=0;for(let n=0;n<t.length;n++){if(t[n].cells.length===0){i++;continue}t[n-i]=t[n],e[n-i]=n}return t.length-=i,e.length-=i,e}function M(t,e){const i=F(e,()=>({cells:[],columns:[]}));let n=0;for(let s=0;s<t.length;s++){const{data:{rows:c,indexes:r},width:l}=t[s];for(let h=0;h<c.length;h++){const{cells:a,columns:d}=c[h],g=i[r[h]];for(let p=0;p<a.length;p++)g.cells.push(a[p]),g.columns.push(d[p]+n)}n+=l}const o=wt(i);return{width:n,height:e,data:{rows:i,indexes:o}}}function mt(t){return function(i){let n=i[0].width,o=n;for(let r=1;r<i.length;r++){const l=i[r];n=v(n,l.width),o=j(o,l.width)}const s=t(n,o)?n:o,c=L("width",s);for(let r=0;r<i.length;r++)c(i[r]);return B(i,s)}}function pt(t){return e=>{let i=e[0].height,n=i;for(let c=1;c<e.length;c++)i=v(i,e[c].height),n=j(n,e[c].height);const o=t(i,n)?i:n,s=L("height",o);for(let c=0;c<e.length;c++)s(e[c]);return M(e,o)}}var A;(function(t){t.Header="header",t.Index="index",t.Value="value",t.Corner="corner"})(A||(A={}));const xt={head:"height",indexes:"width"},q={head:"indexes",indexes:"head"};function _(t){return{head:null,indexes:null,body:{height:1,width:1,data:{rows:[{cells:[{height:1,width:1,value:t,type:A.Value}],columns:[0]}],indexes:[0]}}}}function kt(t,e){return t.width===e.width?t.height<e.height?t:e:t.width>e.width?t:e}function yt(t,e){return t.height===e.height?t.width<e.width?t:e:t.height>e.height?t:e}const Pt={head:kt,indexes:yt};function It(t,e,i){const{[e]:n}=t[0];if(!n)return null;const o=Pt[e],s=[n];let c=n,r=n.height,l=n.width,h=n.height,a=n.width;for(let p=1;p<t.length;p++){const k=t[p][e];if(!k)return null;c=o(c,k),h=j(h,k.height),a=j(a,k.width),r=v(r,k.height),l=v(l,k.width),s.push(k)}const d=i(r,h),g=i(l,a);return!(e==="head"?d:g)||!at({blocks:s,width:g?l:a,widthIsLcm:g,height:d?r:h,heightIsLcm:d})?null:c}function K({head:t,indexes:e,cornerCellValue:i}){return({body:n,head:o,indexes:s})=>{if(!t&&!e)return n;const c=t&&o!==null,r=e&&s!==null,l=r?M([s,n],n.height):n,h=n.width+(r?s.width:0);if(!c)return l;if(!r)return B([o,l],h);for(let d=0;d<o.data.rows.length;d++)O(o.data.rows[d].columns,s.width);const a=o.data.rows[0];return a.cells.unshift({height:o.height,width:s.width,value:i,type:A.Corner}),a.columns.unshift(0),B([o,l],h)}}function Tt(t,e,i,n){const o=[];for(let s=0;s<t.length;s++){const c=t[s],{[e]:r,[q[e]]:l}=c;if(r===null)return null;if(!i||!l){o.push(r);continue}switch(e){case"indexes":{const h=r.data.indexes.slice();O(h,l.height),h.unshift(0),o.push({height:r.height+l.height,width:r.width,data:{rows:[{cells:[{height:l.height,width:r.width,value:n,type:A.Corner}],columns:[0]},...r.data.rows],indexes:h}});break}case"head":{const h=r.data.rows[0].columns.slice();O(h,l.width),h.unshift(0),o.push({height:r.height,width:r.width+l.width,data:{rows:[{cells:[{height:r.height,width:l.width,value:n,type:A.Corner},...r.data.rows[0].cells],columns:h},...r.data.rows.slice(1)],indexes:r.data.indexes}});break}default:throw new Error(`Unknown table component: ${e}`)}}return o}const St={head:mt,indexes:pt};function z({deduplicationComponent:t,isProportionalResize:e,cornerCellValue:i}){const n=St[t](e),o=q[t];return s=>{const c=It(s,t,e),r=c===null,l=Tt(s,o,r,i),h=s.map(K({[t]:r,[o]:l===null,cornerCellValue:i})),a=n(h),d=xt[o];return c&&L(d,a[d])(c),{body:a,baked:h,[t]:c,[o]:l&&n(l)}}}const $=t=>t===null||typeof t!="object";function Rt(t){return typeof t=="object"&&t!==null}function At(t){return Rt(t)&&!Array.isArray(t)}function H(t,e){return t===void 0?e:(e.value<t.value?t.left=H(t.left,e):t.right=H(t.right,e),t)}function N(t,e){t!==void 0&&(N(t.left,e),e(t),N(t.right,e))}function Et(){let t=0;const e={};return i=>{const n=Object.entries(i);let o;for(const[r,l]of n){const h=e[r]??={key:r,val:l,value:t++};h.val=l,h.left=void 0,h.right=void 0,o=H(o,h)}const s=[],c=[];return N(o,r=>{s.push(r.key),c.push(r.val)}),[s,c]}}function Ct(t){return(e,i)=>(e-i)/i<=t}function _t({cornerCellValue:t,joinPrimitiveArrayValues:e,combineArraysOfObjects:i,proportionalSizeAdjustmentThreshold:n=1,collapseIndexes:o,stabilizeOrderOfPropertiesInArraysOfObjects:s=!0}){const c=Ct(n),r=z({deduplicationComponent:"head",isProportionalResize:c,cornerCellValue:t}),l=z({deduplicationComponent:"indexes",isProportionalResize:c,cornerCellValue:t});function h(u,w){const{baked:f,indexes:m}=u,x=m!==null;if(x&&o){let R=0,E=f[0].height;const{rows:C,indexes:U}=m.data;for(let b=0;b<C.length;b++){const W=C[b];U[b]>=E&&(E+=f[++R].height);const J=w[R];W.cells[0].value=`${J}.${W.cells[0].value}`}return}const y=F(f.length,()=>({cells:[],columns:[]})),I=new Array(0);let T=0;for(let R=0;R<f.length;R++){const E=y[R],{height:C}=f[R];E.cells.push({height:C,width:1,value:w[R],type:A.Index}),E.columns.push(0),I.push(T),T+=C}const V={height:T,width:1,data:{rows:y,indexes:I}};u.indexes=x?M([V,m],T):V}function a(u,w){const{baked:f,head:m}=u,x=m!==null,P={cells:[],columns:[]};let y=0;for(let I=0;I<f.length;I++){const{width:T}=f[I];P.cells.push({height:1,width:T,value:w[I],type:A.Header}),P.columns.push(y),y+=T}x&&(m.data.rows.unshift(P),O(m.data.indexes,1),m.data.indexes.unshift(0)),u.head={width:y,height:x?m.height+1:1,data:x?m.data:{rows:[P],indexes:[0]}}}function d(u,w){const f=r(w);return h(f,u),delete f.baked,f}function g(u,w){const f=l(w);return a(f,u),delete f.baked,f}function p(u){const w=Object.keys(u);return w.length===0?_(""):g(w,w.map(f=>S(u[f])))}function k(u,w){const f=new Array(u.length),m=new Array(u.length);for(let x=0;x<u.length;x++)f[x]=String(x+1),m[x]=w(u[x]);return d(f,m)}function S(u){if($(u))return _(u);if(Array.isArray(u)){if(u.length===0)return _("");let w=!0,f=!0,m=0;for(;m<u.length&&(w||f);)w=w&&$(u[m]),f=f&&At(u[m]),m++;if(w)return _(u.join(", "));if(i&&f)return p(Object.assign({},...u));if(s&&f){const x=Et();return k(u,P=>{const[y,I]=x(P);return y.length===0?_(""):g(y,I.map(S))})}return k(u,S)}return p(u)}return S}function bt(t){const e=_t(t),i=K({cornerCellValue:t.cornerCellValue,head:!0,indexes:!0});return n=>i(e(n))}function Jt(t={}){const e={};for(const[o,s]of Object.entries(t))e[o]=s.with(1,{...s[1],"ui:options":{...s[1]["ui:options"],title:o}});const i=st(e),n=i.uiSchema;for(const o of Object.keys(n))n[o]={...n[o],"ui:options":{...n[o]?.["ui:options"],layouts:{"object-properties":{style:"display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;"}}}};return i}bt({cornerCellValue:"â„–",joinPrimitiveArrayValues:!0});export{Ut as D,rt as a,Jt as c};
