import{A as o,B as m,C as d,D as v,E as l,F as p,G as b,H as g,I as u,J as _,K as k,L as w,M as F,N as M,O as y,P as A,Q as E}from"./render.H0AegGA0.js";class x{anchor;#s=new Map;#t=new Map;#e=new Map;#a=!0;constructor(t,a=!0){this.anchor=t,this.#a=a}#r=()=>{var t=o;if(this.#s.has(t)){var a=this.#s.get(t),s=this.#t.get(a);if(s)m(s);else{var e=this.#e.get(a);e&&(this.#t.set(a,e.effect),this.#e.delete(a),e.fragment.lastChild.remove(),this.anchor.before(e.fragment),s=e.effect)}for(const[r,i]of this.#s){if(this.#s.delete(r),r===t)break;const f=this.#e.get(i);f&&(d(f.effect),this.#e.delete(i))}for(const[r,i]of this.#t){if(r===a)continue;const f=()=>{if(Array.from(this.#s.values()).includes(r)){var h=document.createDocumentFragment();b(i,h),h.append(l()),this.#e.set(r,{effect:i,fragment:h})}else d(i);this.#t.delete(r)};this.#a||!s?v(i,f,!1):f()}}};ensure(t,a){var s=o,e=g();if(a&&!this.#t.has(t)&&!this.#e.has(t))if(e){var r=document.createDocumentFragment(),i=l();r.append(i),this.#e.set(t,{effect:p(()=>a(i)),fragment:r})}else this.#t.set(t,p(()=>a(this.anchor)));if(this.#s.set(s,t),e){for(const[f,n]of this.#t)f===t?s.skipped_effects.delete(n):s.skipped_effects.add(n);for(const[f,n]of this.#e)f===t?s.skipped_effects.delete(n.effect):s.skipped_effects.add(n.effect);s.add_callback(this.#r)}else u&&(this.anchor=_),this.#r()}}function C(c,t,...a){var s=new x(c);k(()=>{const e=t()??null;s.ensure(e,e&&(r=>e(r,...a)))},w)}function D(c){return(t,...a)=>{var s=c(...a),e;if(u)e=_,A();else{var r=s.render().trim(),i=F(r);e=E(i),t.before(e)}const f=s.setup?.(e);M(e,e),typeof f=="function"&&y(f)}}export{x as B,D as c,C as s};
