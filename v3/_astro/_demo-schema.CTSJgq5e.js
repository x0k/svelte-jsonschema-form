import{t as G,e as Q,n as X,f as Y,a as tt,u as et,b as nt,c as it}from"./schemas.Dnna5CW9.js";import"./assert.CfCUMcqC.js";import"./file-include.BLwRfoS7.js";import"./shared.Dn26_Gyq.js";const jt={checkbox:[nt,{},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],checkboxes:[et,{"ui:components":{arrayField:"multiEnumField"}},{oninput:"inputCheckbox",onchange:"changeCheckbox",onblur:"visitCheckbox"}],file:[tt,{"ui:components":{stringField:"fileField"}},{onchange:"changeFile",onblur:"visitFile"}],multiFile:[Y,{"ui:components":{arrayField:"arrayFilesField"}},{onchange:"changeFile",onblur:"visitFile"}],number:[X,{},{oninput:"inputNumber",onchange:"changeNumber",onblur:"visitNumber"}],select:[Q,{"ui:components":{stringField:"enumField"}},{oninput:"inputSelect",onchange:"changeSelect",onblur:"visitSelect"}],text:[G,{},{oninput:"inputText",onchange:"changeText",onblur:"visitText"}]},F=(t,e)=>Array.from(new Array(t),(i,n)=>e(n));function O(t,e){for(let i=0;i<t.length;i++)t[i]+=e}function ot({rows:t,indexes:e},i){for(let n=0;n<t.length;n++){e[n]=e[n]*i;const o=t[n].cells;for(let c=0;c<o.length;c++)o[c].height=o[c].height*i}}function st({rows:t},e){for(let i=0;i<t.length;i++){const{cells:n,columns:o}=t[i];for(let c=0;c<n.length;c++)n[c].width=n[c].width*e,o[c]=o[c]*e}}const j=(t,e)=>t>e?t:e,D=(t,e)=>t?D(e%t,t):e,B=(t,e)=>t*e/D(t,e);function ct({blocks:t,width:e,heightIsLcm:i=!0,height:n,widthIsLcm:o=!0}){const c=t.map(l=>{const s=o?e/l.width:1,r=i?n/l.height:1,{rows:h,indexes:u}=l.data,d=F(n,()=>new Array(e));for(let g=0;g<h.length;g++){const p=u[g],{cells:k,columns:S}=h[g];for(let a=0;a<k.length;a++){const w=k[a],f=p*r;let m=f+w.height*r;!i&&m===l.height&&m<n&&(m=n);const x=S[a]*s;let I=x+w.width*s;!o&&I===l.width&&I<e&&(I=e);for(let y=f;y<m;y++){const P=d[y];for(let T=x;T<I;T++)P[T]=w}}}return d});for(let l=0;l<n;l++){const s=c[0][l];for(let r=0;r<e;r++){const h=s[r];for(let u=1;u<t.length;u++){const d=c[u][l][r];if(!d||h.value!==d.value)return!1}}l++}return!0}function Z({rows:t},e,i){for(const[n,o]of e){const c=t[n].cells;for(const[l,s]of o)c[l][i]+=s}}function rt({data:t,height:e,width:i}){const n=F(i,()=>0),o=new Array(i),{rows:c}=t;for(let s=0;s<c.length;s++){const{cells:r,columns:h}=c[s];for(let u=0;u<r.length;u++){const d=r[u],g=h[u];n[g]+=d.height,o[g]={cell:d,rowIndex:s,colIndex:u};for(let p=1;p<d.width;p++)n[g+p]+=d.height,o[g+p]=null}}const l=new Map;for(let s=0;s<i;s++){const r=o[s];if(!r)continue;const h=e-n[s];if(h<=0)continue;const u=l.get(r.rowIndex)||new Map;l.set(r.rowIndex,u.set(r.colIndex,h))}Z(t,l,"height")}function lt({data:t,height:e,width:i}){const n=new Array(e),{rows:o,indexes:c}=t;for(let r=0;r<o.length;r++){const{cells:h,columns:u}=o[r];if(h.length===0)continue;const d=h.length-1,g=h[d],p=u[d]+g.width,k={cell:g,indexInRow:d,xTopRightCorner:p},S=c[r];for(let a=S;a<S+g.height;a++){const w=n[a];(!w||p>w.xTopRightCorner)&&(n[a]=k)}}const l=new Set,s=new Map;for(let r=0;r<o.length;r++){const h=c[r],u=n[h];if(!u||l.has(u.cell))continue;l.add(u.cell);const d=i-u.xTopRightCorner;if(d<=0)continue;const g=s.get(r)||new Map;s.set(r,g.set(u.indexInRow,d))}Z(t,s,"width")}const ht={width:st,height:ot},at={width:lt,height:rt};function L(t,e){const i=ht[t],n=at[t];return o=>{const c=Math.floor(e/o[t]);c>1&&i(o.data,c);let l=o[t];o[t]=e,e-l*c>0&&n(o)}}function H(t,e){const i=new Array(0),n=new Array(0);let o=0;for(let c=0;c<t.length;c++){const{data:l,height:s}=t[c];for(let r=0;r<l.rows.length;r++)n.push(o+l.indexes[r]),i.push(l.rows[r]);o+=s}return{width:e,height:o,data:{rows:i,indexes:n}}}function ut(t){const e=new Array(t.length);let i=0;for(let n=0;n<t.length;n++){if(t[n].cells.length===0){i++;continue}t[n-i]=t[n],e[n-i]=n}return t.length-=i,e.length-=i,e}function M(t,e){const i=F(e,()=>({cells:[],columns:[]}));let n=0;for(let c=0;c<t.length;c++){const{data:{rows:l,indexes:s},width:r}=t[c];for(let h=0;h<l.length;h++){const{cells:u,columns:d}=l[h],g=i[s[h]];for(let p=0;p<u.length;p++)g.cells.push(u[p]),g.columns.push(d[p]+n)}n+=r}const o=ut(i);return{width:n,height:e,data:{rows:i,indexes:o}}}function dt(t){return function(i){let n=i[0].width,o=n;for(let s=1;s<i.length;s++){const r=i[s];n=B(n,r.width),o=j(o,r.width)}const c=t(n,o)?n:o,l=L("width",c);for(let s=0;s<i.length;s++)l(i[s]);return H(i,c)}}function ft(t){return e=>{let i=e[0].height,n=i;for(let l=1;l<e.length;l++)i=B(i,e[l].height),n=j(n,e[l].height);const o=t(i,n)?i:n,c=L("height",o);for(let l=0;l<e.length;l++)c(e[l]);return M(e,o)}}var R;(function(t){t.Header="header",t.Index="index",t.Value="value",t.Corner="corner"})(R||(R={}));const gt={head:"height",indexes:"width"},q={head:"indexes",indexes:"head"};function _(t){return{head:null,indexes:null,body:{height:1,width:1,data:{rows:[{cells:[{height:1,width:1,value:t,type:R.Value}],columns:[0]}],indexes:[0]}}}}function wt(t,e){return t.width===e.width?t.height<e.height?t:e:t.width>e.width?t:e}function mt(t,e){return t.height===e.height?t.width<e.width?t:e:t.height>e.height?t:e}const pt={head:wt,indexes:mt};function xt(t,e,i){const{[e]:n}=t[0];if(!n)return null;const o=pt[e],c=[n];let l=n,s=n.height,r=n.width,h=n.height,u=n.width;for(let p=1;p<t.length;p++){const k=t[p][e];if(!k)return null;l=o(l,k),h=j(h,k.height),u=j(u,k.width),s=B(s,k.height),r=B(r,k.width),c.push(k)}const d=i(s,h),g=i(r,u);return!(e==="head"?d:g)||!ct({blocks:c,width:g?r:u,widthIsLcm:g,height:d?s:h,heightIsLcm:d})?null:l}function K({head:t,indexes:e,cornerCellValue:i}){return({body:n,head:o,indexes:c})=>{if(!t&&!e)return n;const l=t&&o!==null,s=e&&c!==null,r=s?M([c,n],n.height):n,h=n.width+(s?c.width:0);if(!l)return r;if(!s)return H([o,r],h);for(let d=0;d<o.data.rows.length;d++)O(o.data.rows[d].columns,c.width);const u=o.data.rows[0];return u.cells.unshift({height:o.height,width:c.width,value:i,type:R.Corner}),u.columns.unshift(0),H([o,r],h)}}function kt(t,e,i,n){const o=[];for(let c=0;c<t.length;c++){const l=t[c],{[e]:s,[q[e]]:r}=l;if(s===null)return null;if(!i||!r){o.push(s);continue}switch(e){case"indexes":{const h=s.data.indexes.slice();O(h,r.height),h.unshift(0),o.push({height:s.height+r.height,width:s.width,data:{rows:[{cells:[{height:r.height,width:s.width,value:n,type:R.Corner}],columns:[0]},...s.data.rows],indexes:h}});break}case"head":{const h=s.data.rows[0].columns.slice();O(h,r.width),h.unshift(0),o.push({height:s.height,width:s.width+r.width,data:{rows:[{cells:[{height:s.height,width:r.width,value:n,type:R.Corner},...s.data.rows[0].cells],columns:h},...s.data.rows.slice(1)],indexes:s.data.indexes}});break}default:throw new Error(`Unknown table component: ${e}`)}}return o}const yt={head:dt,indexes:ft};function z({deduplicationComponent:t,isProportionalResize:e,cornerCellValue:i}){const n=yt[t](e),o=q[t];return c=>{const l=xt(c,t,e),s=l===null,r=kt(c,o,s,i),h=c.map(K({[t]:s,[o]:r===null,cornerCellValue:i})),u=n(h),d=gt[o];return l&&L(d,u[d])(l),{body:u,baked:h,[t]:l,[o]:r&&n(r)}}}const $=t=>t===null||typeof t!="object";function It(t){return typeof t=="object"&&t!==null}function Pt(t){return It(t)&&!Array.isArray(t)}function v(t,e){return t===void 0?e:(e.value<t.value?t.left=v(t.left,e):t.right=v(t.right,e),t)}function N(t,e){t!==void 0&&(N(t.left,e),e(t),N(t.right,e))}function Tt(){let t=0;const e={};return i=>{const n=Object.entries(i);let o;for(const[s,r]of n){const h=e[s]??={key:s,val:r,value:t++};h.val=r,h.left=void 0,h.right=void 0,o=v(o,h)}const c=[],l=[];return N(o,s=>{c.push(s.key),l.push(s.val)}),[c,l]}}function St(t){return(e,i)=>(e-i)/i<=t}function Ct({cornerCellValue:t,joinPrimitiveArrayValues:e,combineArraysOfObjects:i,proportionalSizeAdjustmentThreshold:n=1,collapseIndexes:o,stabilizeOrderOfPropertiesInArraysOfObjects:c=!0}){const l=St(n),s=z({deduplicationComponent:"head",isProportionalResize:l,cornerCellValue:t}),r=z({deduplicationComponent:"indexes",isProportionalResize:l,cornerCellValue:t});function h(a,w){const{baked:f,indexes:m}=a,x=m!==null;if(x&&o){let C=0,E=f[0].height;const{rows:A,indexes:U}=m.data;for(let b=0;b<A.length;b++){const W=A[b];U[b]>=E&&(E+=f[++C].height);const J=w[C];W.cells[0].value=`${J}.${W.cells[0].value}`}return}const y=F(f.length,()=>({cells:[],columns:[]})),P=new Array(0);let T=0;for(let C=0;C<f.length;C++){const E=y[C],{height:A}=f[C];E.cells.push({height:A,width:1,value:w[C],type:R.Index}),E.columns.push(0),P.push(T),T+=A}const V={height:T,width:1,data:{rows:y,indexes:P}};a.indexes=x?M([V,m],T):V}function u(a,w){const{baked:f,head:m}=a,x=m!==null,I={cells:[],columns:[]};let y=0;for(let P=0;P<f.length;P++){const{width:T}=f[P];I.cells.push({height:1,width:T,value:w[P],type:R.Header}),I.columns.push(y),y+=T}x&&(m.data.rows.unshift(I),O(m.data.indexes,1),m.data.indexes.unshift(0)),a.head={width:y,height:x?m.height+1:1,data:x?m.data:{rows:[I],indexes:[0]}}}function d(a,w){const f=s(w);return h(f,a),delete f.baked,f}function g(a,w){const f=r(w);return u(f,a),delete f.baked,f}function p(a){const w=Object.keys(a);return w.length===0?_(""):g(w,w.map(f=>S(a[f])))}function k(a,w){const f=new Array(a.length),m=new Array(a.length);for(let x=0;x<a.length;x++)f[x]=String(x+1),m[x]=w(a[x]);return d(f,m)}function S(a){if($(a))return _(a);if(Array.isArray(a)){if(a.length===0)return _("");let w=!0,f=!0,m=0;for(;m<a.length&&(w||f);)w=w&&$(a[m]),f=f&&Pt(a[m]),m++;if(w)return _(a.join(", "));if(i&&f)return p(Object.assign({},...a));if(c&&f){const x=Tt();return k(a,I=>{const[y,P]=x(I);return y.length===0?_(""):g(y,P.map(S))})}return k(a,S)}return p(a)}return S}function Rt(t){const e=Ct(t),i=K({cornerCellValue:t.cornerCellValue,head:!0,indexes:!0});return n=>i(e(n))}function Bt(t={}){const e={};for(const[o,c]of Object.entries(t))e[o]=c.with(1,{...c[1],"ui:options":{...c[1]["ui:options"],title:o}});const i=it(e),n=i.uiSchema;for(const o of Object.keys(n))n[o]={...n[o],"ui:options":{...n[o]?.["ui:options"],layouts:{"object-properties":{style:"display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;"}}}};return i}Rt({cornerCellValue:"â„–",joinPrimitiveArrayValues:!0});export{jt as D,Bt as c};
